<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="ç¨‹æµ·ç›"><meta name="copyright" content="ç¨‹æµ·ç›"><meta name="generator" content="Hexo 5.2.0"><meta name="theme" content="hexo-theme-yun"><title>Tensorflow å·ç§¯ç½‘ç»œ | Ashley</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.24/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_j5gk85dg4pf.js" async></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.min.js"></script><script>document.addEventListener("DOMContentLoaded", () => {
  Yun.utils.renderKatex();
});</script><script src="https://cdn.jsdelivr.net/npm/pjax@latest/pjax.min.js" defer></script><script src="/js/pjax.js" defer></script><script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script><link rel="icon" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"allmainashley.github.io","root":"/","title":"ç›å§œè‘±èŠ±é±¼","version":"1.6.1","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.xml"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><link rel="alternate" href="/atom.xml" title="Ashley" type="application/atom+xml"><meta name="description" content="å‰è¨€kearsä¸­æ–‡æ–‡æ¡£ * ä»£è¡¨optionalï¼Œåœ¨æ­å»ºåˆ¤æ–­æ˜¯çŒ«è¿˜æ˜¯ç‹—çš„å·ç§¯ç¥ç»ç½‘ç»œä¸­,ä¸æ˜¯å¿…å¤‡æ­¥éª¤ã€‚ Dogs vs. Catsæ•°æ®é›†ä¸‹è½½åœ°å€ PretreatmentUnzip datas1234567import osimport zipfilelocal_zip &#x3D; &amp;#x27;&#x2F;tmp&#x2F;cats_and_dogs_filtered.zip&amp;#x27;zip_ref &#x3D; zipfile.Z">
<meta property="og:type" content="article">
<meta property="og:title" content="Tensorflow å·ç§¯ç½‘ç»œ">
<meta property="og:url" content="https://allmainashley.github.io/2020/09/30/Notes/Machine%20Learning/Tensorflow%20Convolutional%20Neural%20Networks/index.html">
<meta property="og:site_name" content="Ashley">
<meta property="og:description" content="å‰è¨€kearsä¸­æ–‡æ–‡æ¡£ * ä»£è¡¨optionalï¼Œåœ¨æ­å»ºåˆ¤æ–­æ˜¯çŒ«è¿˜æ˜¯ç‹—çš„å·ç§¯ç¥ç»ç½‘ç»œä¸­,ä¸æ˜¯å¿…å¤‡æ­¥éª¤ã€‚ Dogs vs. Catsæ•°æ®é›†ä¸‹è½½åœ°å€ PretreatmentUnzip datas1234567import osimport zipfilelocal_zip &#x3D; &amp;#x27;&#x2F;tmp&#x2F;cats_and_dogs_filtered.zip&amp;#x27;zip_ref &#x3D; zipfile.Z">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200808160234.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200808160235.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200808160236.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200808155700.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200809150008.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200809150119.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200809150120.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200810114345.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200810114437.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200809154401.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200809154408.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200814091339.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200814091340.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200813122410.png">
<meta property="article:published_time" content="2020-09-29T16:15:53.018Z">
<meta property="article:modified_time" content="2020-08-18T11:08:52.987Z">
<meta property="article:author" content="ç¨‹æµ·ç›">
<meta property="article:tag" content="Tensorflow">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200808160234.png"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="ç¨‹æµ·ç›"><img width="96" loading="lazy" src="/images/1.jpg" alt="ç¨‹æµ·ç›"><span class="site-author-status" title="Fall in love with lsh.">ğŸ’˜</span></a><div class="site-author-name"><a href="/about/">ç¨‹æµ·ç›</a></div><a class="site-name" href="/about/site.html">Ashley</a><sub class="site-subtitle">Face to new life and SAY HEY.</sub><div class="site-desciption">åšä¸ªå¿«ä¹çš„ç¬¨è›‹</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">22</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">11</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">23</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-clipboard-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/AllMainAshley" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:ashleyallmain@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a><a class="links-item hty-icon-button" href="/girls/" title="å–œæ¬¢çš„å¥³å­©å­" style="color:hotpink"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-women-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Dogs-vs-Cats"><span class="toc-number">2.</span> <span class="toc-text">Dogs vs. Cats</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Pretreatment"><span class="toc-number">2.1.</span> <span class="toc-text">Pretreatment</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Unzip-datas"><span class="toc-number">2.1.1.</span> <span class="toc-text">Unzip datas</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Define-Directories"><span class="toc-number">2.1.2.</span> <span class="toc-text">Define Directories</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Load-into-Python-lists"><span class="toc-number">2.1.3.</span> <span class="toc-text">* Load into Python lists</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Print-picture-numbers"><span class="toc-number">2.1.4.</span> <span class="toc-text">* Print picture numbers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Visualization"><span class="toc-number">2.1.5.</span> <span class="toc-text">* Visualization</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Build-model"><span class="toc-number">2.1.6.</span> <span class="toc-text">Build model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Compile"><span class="toc-number">2.1.7.</span> <span class="toc-text">Compile</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Data-Preprocessing"><span class="toc-number">2.2.</span> <span class="toc-text">Data Preprocessing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Create-image-generator"><span class="toc-number">2.2.1.</span> <span class="toc-text">Create image generator</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Training"><span class="toc-number">2.3.</span> <span class="toc-text">Training</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Running-the-model"><span class="toc-number">2.4.</span> <span class="toc-text">Running the model</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Evaluating-Accuracy-and-Loss-for-the-Model"><span class="toc-number">2.5.</span> <span class="toc-text">Evaluating Accuracy and Loss for the Model</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Recap"><span class="toc-number">2.6.</span> <span class="toc-text">Recap</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Augmentation"><span class="toc-number">3.</span> <span class="toc-text">Augmentation</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Transfer-Learning"><span class="toc-number">4.</span> <span class="toc-text">Transfer Learning</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#InceptionV3"><span class="toc-number">4.1.</span> <span class="toc-text">InceptionV3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Model"><span class="toc-number">4.2.</span> <span class="toc-text">Model</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ImageDataGenerator"><span class="toc-number">4.3.</span> <span class="toc-text">ImageDataGenerator</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Model-Fit"><span class="toc-number">4.4.</span> <span class="toc-text">Model Fit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dropout"><span class="toc-number">4.5.</span> <span class="toc-text">Dropout</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Multiclass-Classification"><span class="toc-number">5.</span> <span class="toc-text">Multiclass Classification</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ImageDataGenerator-1"><span class="toc-number">5.1.</span> <span class="toc-text">ImageDataGenerator</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Model-1"><span class="toc-number">5.2.</span> <span class="toc-text">Model</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Compile-1"><span class="toc-number">5.3.</span> <span class="toc-text">Compile</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Model-Fit-1"><span class="toc-number">5.4.</span> <span class="toc-text">Model Fit</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Q-amp-A"><span class="toc-number">6.</span> <span class="toc-text">Q&amp;A</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-Exercise1"><span class="toc-number">6.1.</span> <span class="toc-text">Â Week2 Exercise1Â </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Spilt-Data"><span class="toc-number">6.1.1.</span> <span class="toc-text">Spilt Data</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Recap-1"><span class="toc-number">6.1.2.</span> <span class="toc-text">Recap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Plot-loss-And-Accuracy"><span class="toc-number">6.1.3.</span> <span class="toc-text"> Plot loss And Accuracy</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-Exercise4"><span class="toc-number">6.2.</span> <span class="toc-text">Week2 Exercise4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Get-Data"><span class="toc-number">6.2.1.</span> <span class="toc-text">Get Data</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Recap-2"><span class="toc-number">6.2.2.</span> <span class="toc-text">Recap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Add-Dimensional"><span class="toc-number">6.2.3.</span> <span class="toc-text">Add Dimensional</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://allmainashley.github.io/2020/09/30/Notes/Machine%20Learning/Tensorflow%20Convolutional%20Neural%20Networks/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="ç¨‹æµ·ç›"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Ashley"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Tensorflow å·ç§¯ç½‘ç»œ</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="Created: 2020-09-30 00:15:53" itemprop="dateCreated datePublished" datetime="2020-09-30T00:15:53+08:00">2020-09-30</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="Modified: 2020-08-18 19:08:52" itemprop="dateModified" datetime="2020-08-18T19:08:52+08:00">2020-08-18</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="Word count in article"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="Word count in article">4.4k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Reading time"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="Reading time">23m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Notes/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Notes</span></a></span> > <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Notes/Machine-Learning/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Machine Learning</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/Tensorflow/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">Tensorflow</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p><a target="_blank" rel="noopener" href="https://keras.io/zh">kearsä¸­æ–‡æ–‡æ¡£</a></p>
<p><font color=DarkOrange><code>* ä»£è¡¨optionalï¼Œåœ¨æ­å»ºåˆ¤æ–­æ˜¯çŒ«è¿˜æ˜¯ç‹—çš„å·ç§¯ç¥ç»ç½‘ç»œä¸­,ä¸æ˜¯å¿…å¤‡æ­¥éª¤ã€‚</code></font></p>
<h1 id="Dogs-vs-Cats"><a href="#Dogs-vs-Cats" class="headerlink" title="Dogs vs. Cats"></a>Dogs vs. Cats</h1><p><a target="_blank" rel="noopener" href="https://storage.googleapis.com/mledu-datasets/cats_and_dogs_filtered.zip">æ•°æ®é›†ä¸‹è½½åœ°å€</a></p>
<h2 id="Pretreatment"><a href="#Pretreatment" class="headerlink" title="Pretreatment"></a>Pretreatment</h2><h3 id="Unzip-datas"><a href="#Unzip-datas" class="headerlink" title="Unzip datas"></a><font color=Salmon>Unzip datas</font></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"></span><br><span class="line">local_zip = <span class="string">&#x27;/tmp/cats_and_dogs_filtered.zip&#x27;</span></span><br><span class="line">zip_ref = zipfile.ZipFile(local_zip, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">zip_ref.extractall(<span class="string">&#x27;/tmp&#x27;</span>)</span><br><span class="line">zip_ref.close()</span><br></pre></td></tr></table></figure>



<h3 id="Define-Directories"><a href="#Define-Directories" class="headerlink" title="Define Directories"></a><font color=Salmon>Define Directories</font></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">base_dir = <span class="string">&#x27;/tmp/cats_and_dogs_filtered&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹¼æ¥è·¯å¾„</span></span><br><span class="line">train_dir = os.path.join(base_dir, <span class="string">&#x27;train&#x27;</span>) </span><br><span class="line">validation_dir = os.path.join(base_dir, <span class="string">&#x27;validation&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Directory with our training cat/dog pictures</span></span><br><span class="line">train_cats_dir = os.path.join(train_dir, <span class="string">&#x27;cats&#x27;</span>)</span><br><span class="line">train_dogs_dir = os.path.join(train_dir, <span class="string">&#x27;dogs&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Directory with our validation cat/dog pictures</span></span><br><span class="line">validation_cats_dir = os.path.join(validation_dir, <span class="string">&#x27;cats&#x27;</span>)</span><br><span class="line">validation_dogs_dir = os.path.join(validation_dir, <span class="string">&#x27;dogs&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h3 id="Load-into-Python-lists"><a href="#Load-into-Python-lists" class="headerlink" title="* Load into Python lists"></a><font color=Salmon>* Load into Python lists</font></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">train_cat_fnames = os.listdir( train_cats_dir ) <span class="comment">#os.listdir() æ–¹æ³•ç”¨äºè¿”å›æŒ‡å®šçš„æ–‡ä»¶å¤¹åŒ…å«çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„åå­—çš„åˆ—è¡¨</span></span><br><span class="line">train_dog_fnames = os.listdir( train_dogs_dir )</span><br><span class="line"></span><br><span class="line">print(train_cat_fnames[:<span class="number">10</span>])</span><br><span class="line">print(train_dog_fnames[:<span class="number">10</span>])</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">æ‰“å°ç»“æœï¼š</span></span><br><span class="line"><span class="string">[&#x27;cat.277.jpg&#x27;, &#x27;cat.424.jpg&#x27;, &#x27;cat.809.jpg&#x27;, &#x27;cat.148.jpg&#x27;, &#x27;cat.114.jpg&#x27;, &#x27;cat.264.jpg&#x27;, &#x27;cat.392.jpg&#x27;, &#x27;cat.355.jpg&#x27;, &#x27;cat.671.jpg&#x27;, &#x27;cat.562.jpg&#x27;]</span></span><br><span class="line"><span class="string">[&#x27;dog.928.jpg&#x27;, &#x27;dog.88.jpg&#x27;, &#x27;dog.470.jpg&#x27;, &#x27;dog.782.jpg&#x27;, &#x27;dog.346.jpg&#x27;, &#x27;dog.383.jpg&#x27;, &#x27;dog.728.jpg&#x27;, &#x27;dog.979.jpg&#x27;, &#x27;dog.389.jpg&#x27;, &#x27;dog.71.jpg&#x27;]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>



<h3 id="Print-picture-numbers"><a href="#Print-picture-numbers" class="headerlink" title="* Print picture numbers"></a><font color=Salmon>* Print picture numbers</font></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">&#x27;total training cat images :&#x27;</span>, len(os.listdir(      train_cats_dir ) ))</span><br><span class="line">print(<span class="string">&#x27;total training dog images :&#x27;</span>, len(os.listdir(      train_dogs_dir ) ))</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;total validation cat images :&#x27;</span>, len(os.listdir( validation_cats_dir ) ))</span><br><span class="line">print(<span class="string">&#x27;total validation dog images :&#x27;</span>, len(os.listdir( validation_dogs_dir ) ))</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">æ‰“å°ç»“æœï¼š</span></span><br><span class="line"><span class="string">total training cat images : 1000</span></span><br><span class="line"><span class="string">total training dog images : 1000</span></span><br><span class="line"><span class="string">total validation cat images : 500</span></span><br><span class="line"><span class="string">total validation dog images : 500</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>



<h3 id="Visualization"><a href="#Visualization" class="headerlink" title="* Visualization"></a><font color=Salmon>* Visualization</font></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.image <span class="keyword">as</span> mpimg</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># Parameters for our graph; we&#x27;ll output images in a 4x4 configuration</span></span><br><span class="line">nrows = <span class="number">4</span></span><br><span class="line">ncols = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">pic_index = <span class="number">0</span> <span class="comment"># Index for iterating over images</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up matplotlib fig, and size it to fit 4x4 pics</span></span><br><span class="line">fig = plt.gcf()		 <span class="comment"># Get Current Figure</span></span><br><span class="line">fig.set_size_inches(ncols*<span class="number">4</span>, nrows*<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">pic_index+=<span class="number">8</span></span><br><span class="line"></span><br><span class="line">next_cat_pix = [os.path.join(train_cats_dir, fname) </span><br><span class="line">                <span class="keyword">for</span> fname <span class="keyword">in</span> train_cat_fnames[ pic_index<span class="number">-8</span>:pic_index] </span><br><span class="line">               ]</span><br><span class="line"></span><br><span class="line">next_dog_pix = [os.path.join(train_dogs_dir, fname) </span><br><span class="line">                <span class="keyword">for</span> fname <span class="keyword">in</span> train_dog_fnames[ pic_index<span class="number">-8</span>:pic_index]</span><br><span class="line">               ]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, img_path <span class="keyword">in</span> enumerate(next_cat_pix+next_dog_pix):</span><br><span class="line">  <span class="comment"># Set up subplot; subplot indices start at 1</span></span><br><span class="line">  sp = plt.subplot(nrows, ncols, i + <span class="number">1</span>)</span><br><span class="line">  sp.axis(<span class="string">&#x27;Off&#x27;</span>) <span class="comment"># Don&#x27;t show axes (or gridlines)</span></span><br><span class="line"></span><br><span class="line">  img = mpimg.imread(img_path)</span><br><span class="line">  plt.imshow(img)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>



<h3 id="Build-model"><a href="#Build-model" class="headerlink" title="Build model"></a><font color=Salmon>Build model</font></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line">model = tf.keras.models.Sequential([</span><br><span class="line">    <span class="comment"># Note the input shape is the desired size of the image 150x150 with 3 bytes color</span></span><br><span class="line">    tf.keras.layers.Conv2D(<span class="number">16</span>, (<span class="number">3</span>,<span class="number">3</span>), activation=<span class="string">&#x27;relu&#x27;</span>, input_shape=(<span class="number">150</span>, <span class="number">150</span>, <span class="number">3</span>)),</span><br><span class="line">    tf.keras.layers.MaxPooling2D(<span class="number">2</span>,<span class="number">2</span>),</span><br><span class="line">    tf.keras.layers.Conv2D(<span class="number">32</span>, (<span class="number">3</span>,<span class="number">3</span>), activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    tf.keras.layers.MaxPooling2D(<span class="number">2</span>,<span class="number">2</span>), </span><br><span class="line">    tf.keras.layers.Conv2D(<span class="number">64</span>, (<span class="number">3</span>,<span class="number">3</span>), activation=<span class="string">&#x27;relu&#x27;</span>), </span><br><span class="line">    tf.keras.layers.MaxPooling2D(<span class="number">2</span>,<span class="number">2</span>),</span><br><span class="line">    <span class="comment"># Flatten the results to feed into a DNN</span></span><br><span class="line">    tf.keras.layers.Flatten(), </span><br><span class="line">    <span class="comment"># 512 neuron hidden layer</span></span><br><span class="line">    tf.keras.layers.Dense(<span class="number">512</span>, activation=<span class="string">&#x27;relu&#x27;</span>), </span><br><span class="line">    <span class="comment"># Only 1 output neuron. It will contain a value from 0-1 where 0 for 1 class (&#x27;cats&#x27;) and 1 for the other (&#x27;dogs&#x27;)</span></span><br><span class="line">    tf.keras.layers.Dense(<span class="number">1</span>, activation=<span class="string">&#x27;sigmoid&#x27;</span>)  </span><br><span class="line">]</span><br><span class="line">    </span><br><span class="line">model.summary()</span><br></pre></td></tr></table></figure>

<p>æ‰“å°æ¨¡å‹æ¦‚è¿°ä¿¡æ¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Model: &quot;sequential_2&quot;</span><br><span class="line">_________________________________________________________________</span><br><span class="line">Layer (type)                 Output Shape              Param #   </span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">conv2d_6 (Conv2D)            (None, 148, 148, 16)      448       </span><br><span class="line">_________________________________________________________________</span><br><span class="line">max_pooling2d_6 (MaxPooling2 (None, 74, 74, 16)        0         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv2d_7 (Conv2D)            (None, 72, 72, 32)        4640      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">max_pooling2d_7 (MaxPooling2 (None, 36, 36, 32)        0         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv2d_8 (Conv2D)            (None, 34, 34, 64)        18496     </span><br><span class="line">_________________________________________________________________</span><br><span class="line">max_pooling2d_8 (MaxPooling2 (None, 17, 17, 64)        0         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">flatten_2 (Flatten)          (None, 18496)             0         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">dense_4 (Dense)              (None, 512)               9470464   </span><br><span class="line">_________________________________________________________________</span><br><span class="line">dense_5 (Dense)              (None, 1)                 513       </span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Total params: 9,494,561</span><br><span class="line">Trainable params: 9,494,561</span><br><span class="line">Non-trainable params: 0</span><br><span class="line">_________________________________________________________________</span><br></pre></td></tr></table></figure>



<h3 id="Compile"><a href="#Compile" class="headerlink" title="Compile"></a><font color=Salmon>Compile</font></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras.optimizers <span class="keyword">import</span> RMSprop</span><br><span class="line"></span><br><span class="line">model.compile(optimizer=RMSprop(lr=<span class="number">0.001</span>),</span><br><span class="line">              loss=<span class="string">&#x27;binary_crossentropy&#x27;</span>,</span><br><span class="line">              metrics = [<span class="string">&#x27;accuracy&#x27;</span>])</span><br></pre></td></tr></table></figure>





<h2 id="Data-Preprocessing"><a href="#Data-Preprocessing" class="headerlink" title="Data Preprocessing"></a>Data Preprocessing</h2><h3 id="Create-image-generator"><a href="#Create-image-generator" class="headerlink" title="Create image generator"></a><font color=Salmon>Create image generator</font></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras.preprocessing.image <span class="keyword">import</span> ImageDataGenerator</span><br><span class="line"></span><br><span class="line"><span class="comment"># All images will be rescaled by 1./255.</span></span><br><span class="line">train_datagen = ImageDataGenerator( rescale = <span class="number">1.0</span>/<span class="number">255.</span> )</span><br><span class="line">test_datagen  = ImageDataGenerator( rescale = <span class="number">1.0</span>/<span class="number">255.</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment"># --------------------</span></span><br><span class="line"><span class="comment"># Flow training images in batches of 20 using train_datagen generator</span></span><br><span class="line"><span class="comment"># --------------------</span></span><br><span class="line">train_generator = train_datagen.flow_from_directory(train_dir,</span><br><span class="line">                                                    batch_size=<span class="number">20</span>,</span><br><span class="line">                                                    class_mode=<span class="string">&#x27;binary&#x27;</span>,</span><br><span class="line">                                                    target_size=(<span class="number">150</span>, <span class="number">150</span>))     </span><br><span class="line"><span class="comment"># --------------------</span></span><br><span class="line"><span class="comment"># Flow validation images in batches of 20 using test_datagen generator</span></span><br><span class="line"><span class="comment"># --------------------</span></span><br><span class="line">validation_generator =  test_datagen.flow_from_directory(validation_dir,</span><br><span class="line">                                                         batch_size=<span class="number">20</span>,</span><br><span class="line">                                                         class_mode  = <span class="string">&#x27;binary&#x27;</span>,</span><br><span class="line">                                                         target_size = (<span class="number">150</span>, <span class="number">150</span>))</span><br></pre></td></tr></table></figure>



<h2 id="Training"><a href="#Training" class="headerlink" title="Training"></a>Training</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">history = model.fit(train_generator,</span><br><span class="line">                    validation_data=validation_generator,</span><br><span class="line">                    steps_per_epoch=<span class="number">100</span>,</span><br><span class="line">                    epochs=<span class="number">15</span>,</span><br><span class="line">                    validation_steps=<span class="number">50</span>,</span><br><span class="line">                    verbose=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>æ‰“å°ç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Epoch 1&#x2F;15</span><br><span class="line">100&#x2F;100 - 55s - loss: 0.0300 - accuracy: 0.9925 - val_loss: 1.9040 - val_accuracy: 0.7120</span><br><span class="line">Epoch 2&#x2F;15</span><br><span class="line">100&#x2F;100 - 55s - loss: 0.0350 - accuracy: 0.9890 - val_loss: 1.7071 - val_accuracy: 0.7210</span><br><span class="line">Epoch 3&#x2F;15</span><br><span class="line">100&#x2F;100 - 55s - loss: 0.0188 - accuracy: 0.9925 - val_loss: 2.0725 - val_accuracy: 0.6950</span><br><span class="line">Epoch 4&#x2F;15</span><br><span class="line">100&#x2F;100 - 55s - loss: 0.0291 - accuracy: 0.9915 - val_loss: 2.3252 - val_accuracy: 0.7080</span><br><span class="line">Epoch 5&#x2F;15</span><br><span class="line">100&#x2F;100 - 55s - loss: 0.0303 - accuracy: 0.9940 - val_loss: 2.1299 - val_accuracy: 0.7340</span><br><span class="line">Epoch 6&#x2F;15</span><br><span class="line">100&#x2F;100 - 55s - loss: 0.0193 - accuracy: 0.9930 - val_loss: 2.0416 - val_accuracy: 0.7400</span><br><span class="line">Epoch 7&#x2F;15</span><br><span class="line">100&#x2F;100 - 55s - loss: 0.0197 - accuracy: 0.9925 - val_loss: 2.1636 - val_accuracy: 0.7300</span><br><span class="line">Epoch 8&#x2F;15</span><br><span class="line">100&#x2F;100 - 55s - loss: 0.0251 - accuracy: 0.9925 - val_loss: 2.4540 - val_accuracy: 0.7360</span><br><span class="line">Epoch 9&#x2F;15</span><br><span class="line">100&#x2F;100 - 55s - loss: 0.0180 - accuracy: 0.9955 - val_loss: 2.7262 - val_accuracy: 0.7260</span><br><span class="line">Epoch 10&#x2F;15</span><br><span class="line">100&#x2F;100 - 60s - loss: 0.0163 - accuracy: 0.9960 - val_loss: 2.8085 - val_accuracy: 0.7040</span><br><span class="line">Epoch 11&#x2F;15</span><br><span class="line">100&#x2F;100 - 55s - loss: 0.0400 - accuracy: 0.9905 - val_loss: 2.6529 - val_accuracy: 0.7270</span><br><span class="line">Epoch 12&#x2F;15</span><br><span class="line">100&#x2F;100 - 55s - loss: 0.0193 - accuracy: 0.9945 - val_loss: 2.8958 - val_accuracy: 0.7220</span><br><span class="line">Epoch 13&#x2F;15</span><br><span class="line">100&#x2F;100 - 55s - loss: 0.0204 - accuracy: 0.9950 - val_loss: 3.2313 - val_accuracy: 0.7250</span><br><span class="line">Epoch 14&#x2F;15</span><br><span class="line">100&#x2F;100 - 55s - loss: 9.9441e-05 - accuracy: 1.0000 - val_loss: 3.5450 - val_accuracy: 0.7270</span><br><span class="line">Epoch 15&#x2F;15</span><br><span class="line">100&#x2F;100 - 55s - loss: 0.0781 - accuracy: 0.9905 - val_loss: 3.2831 - val_accuracy: 0.6940</span><br></pre></td></tr></table></figure>

<h2 id="Running-the-model"><a href="#Running-the-model" class="headerlink" title="Running the model"></a>Running the model</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> google.colab <span class="keyword">import</span> files</span><br><span class="line"><span class="keyword">from</span> keras.preprocessing <span class="keyword">import</span> image</span><br><span class="line"></span><br><span class="line">uploaded=files.upload()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> fn <span class="keyword">in</span> uploaded.keys():</span><br><span class="line"> </span><br><span class="line">  <span class="comment"># predicting images</span></span><br><span class="line">  path=<span class="string">&#x27;/content/&#x27;</span> + fn</span><br><span class="line">  img=image.load_img(path, target_size=(<span class="number">150</span>, <span class="number">150</span>))</span><br><span class="line">  </span><br><span class="line">  x=image.img_to_array(img)</span><br><span class="line">  x=np.expand_dims(x, axis=<span class="number">0</span>)</span><br><span class="line">  images = np.vstack([x])</span><br><span class="line">  </span><br><span class="line">  classes = model.predict(images, batch_size=<span class="number">10</span>)</span><br><span class="line">  </span><br><span class="line">  print(classes[<span class="number">0</span>])</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> classes[<span class="number">0</span>]&gt;<span class="number">0</span>:</span><br><span class="line">    print(fn + <span class="string">&quot; is a dog&quot;</span>)</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    print(fn + <span class="string">&quot; is a cat&quot;</span>)</span><br></pre></td></tr></table></figure>



<p>é€šè¿‡è£å‰ªå›¾ç‰‡ï¼Œå¯ä»¥æ”¹å˜åˆ†ç±»çš„ç»“æœã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200808160234.png" loading="lazy"></p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200808160235.png" loading="lazy"></p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200808160236.png" loading="lazy"></p>
<h2 id="Evaluating-Accuracy-and-Loss-for-the-Model"><a href="#Evaluating-Accuracy-and-Loss-for-the-Model" class="headerlink" title="Evaluating Accuracy and Loss for the Model"></a>Evaluating Accuracy and Loss for the Model</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># Retrieve a list of list results on training and test data</span></span><br><span class="line"><span class="comment"># sets for each training epoch</span></span><br><span class="line"><span class="comment">#-----------------------------------------------------------</span></span><br><span class="line">acc      = history.history[     <span class="string">&#x27;accuracy&#x27;</span> ]</span><br><span class="line">val_acc  = history.history[ <span class="string">&#x27;val_accuracy&#x27;</span> ]</span><br><span class="line">loss     = history.history[    <span class="string">&#x27;loss&#x27;</span> ]</span><br><span class="line">val_loss = history.history[<span class="string">&#x27;val_loss&#x27;</span> ]</span><br><span class="line"></span><br><span class="line">epochs   = range(len(acc)) <span class="comment"># Get number of epochs</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#------------------------------------------------</span></span><br><span class="line"><span class="comment"># Plot training and validation accuracy per epoch</span></span><br><span class="line"><span class="comment">#------------------------------------------------</span></span><br><span class="line">plt.plot  ( epochs,     acc )</span><br><span class="line">plt.plot  ( epochs, val_acc )</span><br><span class="line">plt.title (<span class="string">&#x27;Training and validation accuracy&#x27;</span>)</span><br><span class="line">plt.figure()</span><br><span class="line"></span><br><span class="line"><span class="comment">#------------------------------------------------</span></span><br><span class="line"><span class="comment"># Plot training and validation loss per epoch</span></span><br><span class="line"><span class="comment">#------------------------------------------------</span></span><br><span class="line">plt.plot  ( epochs,     loss )</span><br><span class="line">plt.plot  ( epochs, val_loss )</span><br><span class="line">plt.title (<span class="string">&#x27;Training and validation loss&#x27;</span>   )</span><br></pre></td></tr></table></figure>

<p><font color=SteelBlue>Training</font>  and <font color=DarkOrange>Validation</font></p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200808155700.png" loading="lazy"></p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200809150008.png" loading="lazy"></p>
<h2 id="Recap"><a href="#Recap" class="headerlink" title="Recap"></a>Recap</h2><p><font color=Green>**How to build a Dogs vs. Cats classifier? **</font></p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Unzip datas. è§£å‹æ•°æ®</li>
<li><input checked="" disabled="" type="checkbox"> Define Directories. æŒ‡å®šæ–‡ä»¶å¤¹ </li>
<li><input checked="" disabled="" type="checkbox"> Build the model. æ­å»ºæ¨¡å‹ ï¼ˆmodel.Sequential)</li>
<li><input checked="" disabled="" type="checkbox"> Compile the model. ç¼–è¯‘æ¨¡å‹</li>
<li><input checked="" disabled="" type="checkbox"> Create image generator. åˆ›å»ºå›¾åƒç”Ÿæˆå™¨ï¼ˆæ ‡å‡†åŒ–æ•°æ®ã€flow_from_directoryè¯»æ–‡ä»¶ï¼‰</li>
<li><input checked="" disabled="" type="checkbox"> Train the model. è®­ç»ƒæ¨¡å‹ï¼ˆæ³¨æ„ï¼šæ˜¯model.fit_generator)</li>
<li><input checked="" disabled="" type="checkbox"> Running the model. ï¼ˆæµ‹è¯•æ–°å›¾ç‰‡ï¼‰</li>
<li><input checked="" disabled="" type="checkbox"> Evaluating Accuracy and Loss for the Model. ï¼ˆè¯„ä¼°å‡†ç¡®æ€§å’ŒæŸå¤±ï¼‰</li>
</ul>
<h1 id="Augmentation"><a href="#Augmentation" class="headerlink" title="Augmentation"></a>Augmentation</h1><p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200809150119.png" loading="lazy"></p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200809150120.png" loading="lazy"></p>
<p>å¦‚å›¾ï¼šåœ¨20ä¸ªepochesåï¼Œè®­ç»ƒé›†çš„å‡†ç¡®æ€§æ¥è¿‘1ï¼Œè€ŒéªŒè¯é›†çš„å‡†ç¡®æ€§å¹¶æ²¡æœ‰æå‡ï¼Œè¯´æ˜æ­¤æ—¶å·²ç»å‡ºç°äº†è¿‡æ‹Ÿåˆã€‚</p>
<p><a target="_blank" rel="noopener" href="https://keras.io/zh/preprocessing/image/">ImageDataGenerator è¯¦æƒ…</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras.preprocessing.image <span class="keyword">import</span> ImageDataGenerator</span><br><span class="line"></span><br><span class="line">train_datagen = ImageDataGenerator(</span><br><span class="line">    rescale=(<span class="number">1.</span>/<span class="number">255</span>),</span><br><span class="line">    rotation_range=<span class="number">40</span>,  </span><br><span class="line">    width_shift_range=<span class="number">0.2</span>,</span><br><span class="line">    height_shift_range=<span class="number">0.2</span>,</span><br><span class="line">    shear_range=<span class="number">0.2</span>,</span><br><span class="line">    zoom_range=<span class="number">0.2</span>,</span><br><span class="line">    horizontal_flip=<span class="literal">True</span>,</span><br><span class="line">    fill_mode=<span class="string">&#x27;nearest&#x27;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li><p><strong>rescale</strong>: é‡ç¼©æ”¾å› å­ã€‚é»˜è®¤ä¸º Noneã€‚å¦‚æœæ˜¯ None æˆ– 0ï¼Œä¸è¿›è¡Œç¼©æ”¾ï¼Œå¦åˆ™å°†æ•°æ®ä¹˜ä»¥æ‰€æä¾›çš„å€¼ï¼ˆåœ¨åº”ç”¨ä»»ä½•å…¶ä»–è½¬æ¢ä¹‹å‰ï¼‰ã€‚</p>
</li>
<li><p><strong>rotation_range</strong>: æ•´æ•°ã€‚éšæœºæ—‹è½¬çš„åº¦æ•°èŒƒå›´ã€‚</p>
</li>
<li><p><strong>width_shift_range</strong>: æµ®ç‚¹æ•°ã€ä¸€ç»´æ•°ç»„æˆ–æ•´æ•°</p>
<ul>
<li>float: å¦‚æœ &lt;1ï¼Œåˆ™æ˜¯é™¤ä»¥æ€»å®½åº¦çš„å€¼ï¼Œæˆ–è€…å¦‚æœ &gt;=1ï¼Œåˆ™ä¸ºåƒç´ å€¼ã€‚</li>
<li>1-D æ•°ç»„: æ•°ç»„ä¸­çš„éšæœºå…ƒç´ ã€‚</li>
<li>int: æ¥è‡ªé—´éš” <code>(-width_shift_range, +width_shift_range)</code> ä¹‹é—´çš„æ•´æ•°ä¸ªåƒç´ ã€‚</li>
<li><code>width_shift_range=2</code> æ—¶ï¼Œå¯èƒ½å€¼æ˜¯æ•´æ•° <code>[-1, 0, +1]</code>ï¼Œä¸ <code>width_shift_range=[-1, 0, +1]</code> ç›¸åŒï¼›è€Œ <code>width_shift_range=1.0</code> æ—¶ï¼Œå¯èƒ½å€¼æ˜¯ <code>[-1.0, +1.0)</code> ä¹‹é—´çš„æµ®ç‚¹æ•°ã€‚</li>
</ul>
</li>
<li><p><strong>height_shift_range</strong>: æµ®ç‚¹æ•°ã€ä¸€ç»´æ•°ç»„æˆ–æ•´æ•°</p>
<ul>
<li>float: å¦‚æœ &lt;1ï¼Œåˆ™æ˜¯é™¤ä»¥æ€»å®½åº¦çš„å€¼ï¼Œæˆ–è€…å¦‚æœ &gt;=1ï¼Œåˆ™ä¸ºåƒç´ å€¼ã€‚</li>
<li>1-D array-like: æ•°ç»„ä¸­çš„éšæœºå…ƒç´ ã€‚</li>
<li>int: æ¥è‡ªé—´éš” <code>(-height_shift_range, +height_shift_range)</code> ä¹‹é—´çš„æ•´æ•°ä¸ªåƒç´ ã€‚</li>
<li><code>height_shift_range=2</code> æ—¶ï¼Œå¯èƒ½å€¼æ˜¯æ•´æ•° <code>[-1, 0, +1]</code>ï¼Œä¸ <code>height_shift_range=[-1, 0, +1]</code> ç›¸åŒï¼›è€Œ <code>height_shift_range=1.0</code> æ—¶ï¼Œå¯èƒ½å€¼æ˜¯ <code>[-1.0, +1.0)</code> ä¹‹é—´çš„æµ®ç‚¹æ•°ã€‚</li>
</ul>
</li>
<li><p><strong>shear_range</strong>: æµ®ç‚¹æ•°ã€‚å‰ªåˆ‡å¼ºåº¦ï¼ˆä»¥å¼§åº¦é€†æ—¶é’ˆæ–¹å‘å‰ªåˆ‡è§’åº¦ï¼‰ã€‚</p>
</li>
<li><p><strong>zoom_range</strong>: æµ®ç‚¹æ•° æˆ– <code>[lower, upper]</code>ã€‚éšæœºç¼©æ”¾èŒƒå›´ã€‚å¦‚æœæ˜¯æµ®ç‚¹æ•°ï¼Œ<code>[lower, upper] = [1-zoom_range, 1+zoom_range]</code>ã€‚</p>
</li>
<li><p><strong>horizontal_flip</strong>: å¸ƒå°”å€¼ã€‚éšæœºæ°´å¹³ç¿»è½¬ã€‚ </p>
</li>
<li><p><strong>fill_mode</strong>: {â€œconstantâ€, â€œnearestâ€, â€œreflectâ€ or â€œwrapâ€} ä¹‹ä¸€ã€‚é»˜è®¤ä¸º â€˜nearestâ€™ã€‚è¾“å…¥è¾¹ç•Œä»¥å¤–çš„ç‚¹æ ¹æ®ç»™å®šçš„æ¨¡å¼å¡«å……ï¼š</p>
<ul>
<li><p>â€˜constantâ€™: kkkkkkkk|abcd|kkkkkkkk (cval=k)</p>
</li>
<li><p>â€˜nearestâ€™: aaaaaaaa|abcd|dddddddd</p>
</li>
<li><p>â€˜reflectâ€™: abcddcba|abcd|dcbaabcd</p>
</li>
<li><p>â€˜wrapâ€™: abcdabcd|abcd|abcdabcd</p>
</li>
</ul>
</li>
</ul>
</blockquote>
<p>ä¿®æ”¹äº†ImageDataGeneratoråï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200810114345.png" loading="lazy"></p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200810114437.png" loading="lazy"></p>
<p>å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœåªå¯¹è®­ç»ƒé›†çš„ImageDataGeneratoråšå‡ºä¿®æ”¹ï¼Œä¼šä½¿å¾—éªŒè¯é›†æ³¢åŠ¨è¿‡å¤§ï¼Œæ‰€ä»¥è¦å¯¹è®­ç»ƒé›†å’ŒéªŒè¯é›†çš„ImageDataGeneratoråšå‡ºåŒæ ·çš„ä¿®æ”¹ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200809154401.png" loading="lazy"></p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200809154408.png" loading="lazy"></p>
<h1 id="Transfer-Learning"><a href="#Transfer-Learning" class="headerlink" title="Transfer Learning"></a>Transfer Learning</h1><blockquote>
<p>å‡†å¤‡èµ„æ–™ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1512.00567">Rethinking the Inception Architecture for Computer Vision</a></p>
<p><a target="_blank" rel="noopener" href="http://image-net.org/">Image datasets</a></p>
</blockquote>
<h2 id="InceptionV3"><a href="#InceptionV3" class="headerlink" title="InceptionV3"></a><font color=DarkOrange>InceptionV3</font></h2><p><a target="_blank" rel="noopener" href="https://storage.googleapis.com/mledu-datasets/inception_v3_weights_tf_dim_ordering_tf_kernels_notop.h5">ä¸‹è½½åœ°å€</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> layers</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> Model</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.applications.inception_v3 <span class="keyword">import</span> InceptionV3</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.optimizers <span class="keyword">import</span> RMSprop</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.preprocessing.image <span class="keyword">import</span> ImageDataGenerator</span><br><span class="line"></span><br><span class="line">local_weights_file = <span class="string">&#x27;inception_v3_weights_tf_dim_ordering_tf_kernels_notop.h5&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### é¢„è®­ç»ƒæ¨¡å‹</span></span><br><span class="line">pre_trained_model = InceptionV3(input_shape = (<span class="number">150</span>, <span class="number">150</span>, <span class="number">3</span>), </span><br><span class="line">                                include_top = <span class="literal">False</span>, </span><br><span class="line">                                weights = <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">### è¯»å–ç½‘ç»œæƒå€¼</span></span><br><span class="line">pre_trained_model.load_weights(local_weights_file)</span><br><span class="line"></span><br><span class="line"><span class="comment">### å†»ç»“å±‚</span></span><br><span class="line"><span class="keyword">for</span> layer <span class="keyword">in</span> pre_trained_model.layers:</span><br><span class="line">  layer.trainable = <span class="literal">False</span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># pre_trained_model.summary()	# å› ä¸ºæ¦‚è¿°ä¿¡æ¯å¤ªé•¿ï¼Œæ•…å°†è¿™ä¸€è¡Œæ³¨é‡Šæ‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### çœ‹ä¸€ä¸‹æœ€åä¸€å±‚å½¢çŠ¶</span></span><br><span class="line">last_layer = pre_trained_model.get_layer(<span class="string">&#x27;mixed7&#x27;</span>)		<span class="comment"># è·å¾—InceptionV3ç½‘ç»œmixed7å·ç§¯å±‚</span></span><br><span class="line">print(<span class="string">&#x27;last layer output shape: &#x27;</span>, last_layer.output_shape)</span><br><span class="line">last_output = last_layer.output</span><br></pre></td></tr></table></figure>

<p>æ‰“å°ä¿¡æ¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">last layer output shape:  (None, 7, 7, 768)</span><br></pre></td></tr></table></figure>

<p>è¡¥å……ï¼š</p>
<ul>
<li><p><code>include_top</code>ï¼šå¸ƒå°”å€¼ï¼Œæ˜¯å¦å°†æœ€ä¸Šå±‚çš„å®Œå…¨è¿æ¥å±‚ä½œä¸ºç½‘ç»œçš„æœ€åä¸€å±‚ã€‚é»˜è®¤ä¸º<code>True</code>ã€‚</p>
<p><code>weights</code>ï¼šï¼ˆ<code>None</code>éšæœºåˆå§‹åŒ–ï¼‰ï¼Œ <code>imagenet</code>ï¼ˆåœ¨ImageNetä¸Šè¿›è¡Œé¢„è®­ç»ƒï¼‰æˆ–è¦åŠ è½½çš„weightsæ–‡ä»¶çš„è·¯å¾„ä¹‹ä¸€ã€‚é»˜è®¤ä¸º<code>imagenet</code>ã€‚</p>
</li>
<li><p><code>keras.models.load_model()</code>:  è¯»å–ç½‘ç»œã€æƒé‡<br><code>keras.models.load_weights()</code> : ä»…è¯»å–æƒé‡</p>
</li>
<li><p>è®¾ç½®<code>layer.trainable</code>ä¸º<code>False</code>å°†æ‰€æœ‰å›¾å±‚çš„æƒé‡ä»å¯è®­ç»ƒå˜ä¸ºä¸å¯è®­ç»ƒã€‚è¿™ç§°ä¸ºâ€œå†»ç»“â€å±‚ï¼š<font color=Rainbow>å†»ç»“å±‚çš„çŠ¶æ€åœ¨è®­ç»ƒæœŸé—´ä¸ä¼šæ›´æ–°</font>ï¼ˆä½¿ç”¨è®­ç»ƒ<code>fit()</code>æˆ–ä½¿ç”¨ä¾èµ–äº<code>trainable_weights</code>åº”ç”¨æ¸å˜æ›´æ–°çš„ä»»ä½•è‡ªå®šä¹‰å¾ªç¯è¿›è¡Œè®­ç»ƒæ—¶ï¼‰ã€‚<a target="_blank" rel="noopener" href="https://keras.io/guides/transfer_learning/">è¯¦æƒ…</a></p>
</li>
</ul>
<h2 id="Model"><a href="#Model" class="headerlink" title="Model"></a><font color=DarkOrange>Model</font></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras.optimizers <span class="keyword">import</span> RMSprop</span><br><span class="line"></span><br><span class="line"><span class="comment"># Flatten the output layer to 1 dimension</span></span><br><span class="line">x = layers.Flatten()(last_output)</span><br><span class="line"><span class="comment"># Add a fully connected layer with 1,024 hidden units and ReLU activation</span></span><br><span class="line">x = layers.Dense(<span class="number">1024</span>, activation=<span class="string">&#x27;relu&#x27;</span>)(x)                </span><br><span class="line"><span class="comment"># Add a final sigmoid layer for classification</span></span><br><span class="line">x = layers.Dense  (<span class="number">1</span>, activation=<span class="string">&#x27;sigmoid&#x27;</span>)(x)           </span><br><span class="line"></span><br><span class="line">model = Model( pre_trained_model.input, x) </span><br><span class="line"></span><br><span class="line">model.compile(optimizer = RMSprop(lr=<span class="number">0.0001</span>), </span><br><span class="line">              loss = <span class="string">&#x27;binary_crossentropy&#x27;</span>, </span><br><span class="line">              metrics = [<span class="string">&#x27;accuracy&#x27;</span>])</span><br></pre></td></tr></table></figure>



<h2 id="ImageDataGenerator"><a href="#ImageDataGenerator" class="headerlink" title="ImageDataGenerator"></a><font color=DarkOrange>ImageDataGenerator</font></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">local_zip = <span class="string">&#x27;cats_and_dogs_filtered.zip&#x27;</span></span><br><span class="line"></span><br><span class="line">zip_ref = zipfile.ZipFile(local_zip, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"></span><br><span class="line">zip_ref.extractall()</span><br><span class="line">zip_ref.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define our example directories and files</span></span><br><span class="line">base_dir = <span class="string">&#x27;cats_and_dogs_filtered&#x27;</span></span><br><span class="line"></span><br><span class="line">train_dir = os.path.join( base_dir, <span class="string">&#x27;train&#x27;</span>)</span><br><span class="line">validation_dir = os.path.join( base_dir, <span class="string">&#x27;validation&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">train_cats_dir = os.path.join(train_dir, <span class="string">&#x27;cats&#x27;</span>) <span class="comment"># Directory with our training cat pictures</span></span><br><span class="line">train_dogs_dir = os.path.join(train_dir, <span class="string">&#x27;dogs&#x27;</span>) <span class="comment"># Directory with our training dog pictures</span></span><br><span class="line">validation_cats_dir = os.path.join(validation_dir, <span class="string">&#x27;cats&#x27;</span>) <span class="comment"># Directory with our validation cat pictures</span></span><br><span class="line">validation_dogs_dir = os.path.join(validation_dir, <span class="string">&#x27;dogs&#x27;</span>)<span class="comment"># Directory with our validation dog pictures</span></span><br><span class="line"></span><br><span class="line">train_cat_fnames = os.listdir(train_cats_dir)</span><br><span class="line">train_dog_fnames = os.listdir(train_dogs_dir)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add our data-augmentation parameters to ImageDataGenerator</span></span><br><span class="line">train_datagen = ImageDataGenerator(rescale = <span class="number">1.</span>/<span class="number">255.</span>,</span><br><span class="line">                                   rotation_range = <span class="number">40</span>,</span><br><span class="line">                                   width_shift_range = <span class="number">0.2</span>,</span><br><span class="line">                                   height_shift_range = <span class="number">0.2</span>,</span><br><span class="line">                                   shear_range = <span class="number">0.2</span>,</span><br><span class="line">                                   zoom_range = <span class="number">0.2</span>,</span><br><span class="line">                                   horizontal_flip = <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Note that the validation data should not be augmented!</span></span><br><span class="line">test_datagen = ImageDataGenerator( rescale = <span class="number">1.0</span>/<span class="number">255.</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment"># Flow training images in batches of 20 using train_datagen generator</span></span><br><span class="line">train_generator = train_datagen.flow_from_directory(train_dir,</span><br><span class="line">                                                    batch_size = <span class="number">20</span>,</span><br><span class="line">                                                    class_mode = <span class="string">&#x27;binary&#x27;</span>, </span><br><span class="line">                                                    target_size = (<span class="number">150</span>, <span class="number">150</span>))     </span><br><span class="line"></span><br><span class="line"><span class="comment"># Flow validation images in batches of 20 using test_datagen generator</span></span><br><span class="line">validation_generator =  test_datagen.flow_from_directory( validation_dir,</span><br><span class="line">                                                          batch_size  = <span class="number">20</span>,</span><br><span class="line">                                                          class_mode  = <span class="string">&#x27;binary&#x27;</span>, </span><br><span class="line">                                                          target_size = (<span class="number">150</span>, <span class="number">150</span>))</span><br></pre></td></tr></table></figure>



<h2 id="Model-Fit"><a href="#Model-Fit" class="headerlink" title="Model Fit"></a><font color=DarkOrange>Model Fit</font></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">history = model.fit(</span><br><span class="line">            train_generator,</span><br><span class="line">            validation_data = validation_generator,</span><br><span class="line">            steps_per_epoch = <span class="number">100</span>,</span><br><span class="line">            epochs = <span class="number">20</span>,</span><br><span class="line">            validation_steps = <span class="number">50</span>,</span><br><span class="line">            verbose = <span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>Keras <code>Model</code> ä¸Šçš„ <code>fit()</code> æ–¹æ³•è¿”å›ä¸€ä¸ª <code>History</code> å¯¹è±¡ã€‚<code>History.history</code> å±æ€§æ˜¯ä¸€ä¸ªè®°å½•äº†è¿ç»­è¿­ä»£çš„è®­ç»ƒ/éªŒè¯ï¼ˆå¦‚æœå­˜åœ¨ï¼‰æŸå¤±å€¼å’Œè¯„ä¼°å€¼çš„å­—å…¸ã€‚</li>
<li><code>plt.legend(loc=&#39;ä½ç½®&#39;) </code>: 0è¡¨ç¤º<code>&#39;best&#39;</code>ã€‚ <a target="_blank" rel="noopener" href="https://mofanpy.com/tutorials/data-manipulation/plt/legend/">è¯¦æƒ…</a></li>
<li><code>plt.figure</code>: å®šä¹‰ä¸€ä¸ªå›¾åƒçª—å£ã€‚ <a target="_blank" rel="noopener" href="https://mofanpy.com/tutorials/data-manipulation/plt/figure/">è¯¦æƒ…</a></li>
</ul>
<p>å¯ä»¥çœ‹å‡ºéªŒè¯é›†çš„å‡†ç¡®ç‡é£˜å¿½ä¸å®šï¼Œè¿™æ˜¯å› ä¸ºæ¨¡å‹è¿‡æ‹Ÿåˆäº†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨<strong>Dropout</strong> (éšæœºå¤±æ´») æ¥å‡å°‘è¿‡æ‹Ÿåˆ</p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200814091339.png" loading="lazy"></p>
<h2 id="Dropout"><a href="#Dropout" class="headerlink" title="Dropout"></a><font color=DarkOrange>Dropout</font></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras.optimizers <span class="keyword">import</span> RMSprop</span><br><span class="line"></span><br><span class="line"><span class="comment"># Flatten the output layer to 1 dimension</span></span><br><span class="line">x = layers.Flatten()(last_output)</span><br><span class="line"><span class="comment"># Add a fully connected layer with 1,024 hidden units and ReLU activation</span></span><br><span class="line">x = layers.Dense(<span class="number">1024</span>, activation=<span class="string">&#x27;relu&#x27;</span>)(x)</span><br><span class="line"><span class="comment"># Add a dropout rate of 0.2</span></span><br><span class="line">x = layers.Dropout(<span class="number">0.2</span>)(x)                  </span><br><span class="line"><span class="comment"># Add a final sigmoid layer for classification</span></span><br><span class="line">x = layers.Dense  (<span class="number">1</span>, activation=<span class="string">&#x27;sigmoid&#x27;</span>)(x)           </span><br><span class="line"></span><br><span class="line">model = Model( pre_trained_model.input, x) </span><br><span class="line"></span><br><span class="line">model.compile(optimizer = RMSprop(lr=<span class="number">0.0001</span>), </span><br><span class="line">              loss = <span class="string">&#x27;binary_crossentropy&#x27;</span>, </span><br><span class="line">              metrics = [<span class="string">&#x27;acc&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200814091340.png" loading="lazy"></p>
<h1 id="Multiclass-Classification"><a href="#Multiclass-Classification" class="headerlink" title="Multiclass Classification"></a>Multiclass Classification</h1><p><a target="_blank" rel="noopener" href="http://www.laurencemoroney.com/rock-paper-scissors-dataset/">Rock Paper Scissors</a></p>
<h2 id="ImageDataGenerator-1"><a href="#ImageDataGenerator-1" class="headerlink" title="ImageDataGenerator"></a><font color=MediumAquaMarine>ImageDataGenerator</font></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">train_datagen= ImageDataGenerator(</span><br><span class="line">      rescale = <span class="number">1.</span>/<span class="number">255</span>,</span><br><span class="line">	  rotation_range=<span class="number">40</span>,</span><br><span class="line">      width_shift_range=<span class="number">0.2</span>,</span><br><span class="line">      height_shift_range=<span class="number">0.2</span>,</span><br><span class="line">      shear_range=<span class="number">0.2</span>,</span><br><span class="line">      zoom_range=<span class="number">0.2</span>,</span><br><span class="line">      horizontal_flip=<span class="literal">True</span>,</span><br><span class="line">      fill_mode=<span class="string">&#x27;nearest&#x27;</span>	</span><br><span class="line">)</span><br><span class="line">test_datagen=ImageDataGenerator(</span><br><span class="line">	  rescale = <span class="number">1.</span>/<span class="number">255</span>,</span><br><span class="line">	  rotation_range=<span class="number">40</span>,</span><br><span class="line">      width_shift_range=<span class="number">0.2</span>,</span><br><span class="line">      height_shift_range=<span class="number">0.2</span>,</span><br><span class="line">      shear_range=<span class="number">0.2</span>,</span><br><span class="line">      zoom_range=<span class="number">0.2</span>,</span><br><span class="line">      horizontal_flip=<span class="literal">True</span>,</span><br><span class="line">      fill_mode=<span class="string">&#x27;nearest&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">train_generator=train_datagen.flow_from_directory(</span><br><span class="line">    train_dir,</span><br><span class="line">    target_size=(<span class="number">300</span>,<span class="number">300</span>),</span><br><span class="line">    batch_size=<span class="number">126</span>,</span><br><span class="line">    class_mode=<span class="string">&#x27;categorical&#x27;</span>    <span class="comment"># è¿™ä¸å†æ˜¯äºŒåˆ†ç±»æ‰€ä»¥ï¼Œclass_modeè¦æ›´æ”¹ä¸ºcategorical</span></span><br><span class="line">)</span><br><span class="line">validation_generator=test_datagen.flow_from_directory(</span><br><span class="line">    train_dir,</span><br><span class="line">    target_size=(<span class="number">300</span>, <span class="number">300</span>),</span><br><span class="line">    batch_size=<span class="number">126</span>,</span><br><span class="line">    class_mode=<span class="string">&#x27;categorical&#x27;</span>  <span class="comment"># è¿™ä¸å†æ˜¯äºŒåˆ†ç±»æ‰€ä»¥ï¼Œclass_modeè¦æ›´æ”¹ä¸ºcategorical</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>



<h2 id="Model-1"><a href="#Model-1" class="headerlink" title="Model"></a><font color=MediumAquaMarine>Model</font></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">model=tf.keras.Sequential(</span><br><span class="line">    tf.keras.layers.Conv2D(<span class="number">16</span>,(<span class="number">3</span>,<span class="number">3</span>),activation=<span class="string">&#x27;relu&#x27;</span>,input_shape=(<span class="number">300</span>,<span class="number">300</span>,<span class="number">3</span>)),</span><br><span class="line">    tf.keras.layers.MaxPool2D(<span class="number">2</span>,<span class="number">2</span>),</span><br><span class="line">    tf.keras.layers.Conv2D(<span class="number">32</span>, (<span class="number">3</span>, <span class="number">3</span>), activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    tf.keras.layers.MaxPool2D(<span class="number">2</span>, <span class="number">2</span>),</span><br><span class="line">    tf.keras.layers.Conv2D(<span class="number">64</span>, (<span class="number">3</span>, <span class="number">3</span>), activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    tf.keras.layers.MaxPool2D(<span class="number">2</span>, <span class="number">2</span>),</span><br><span class="line">    tf.keras.layers.Flatten(),</span><br><span class="line">    tf.keras.layers.Dense(<span class="number">512</span>,activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    tf.keras.layers.Dense(<span class="number">3</span>,activation=<span class="string">&#x27;softmax&#x27;</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>



<h2 id="Compile-1"><a href="#Compile-1" class="headerlink" title="Compile"></a><font color=MediumAquaMarine>Compile</font></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">model.compile(loss=<span class="string">&#x27;categorical_crossentropy&#x27;</span>,	<span class="comment">#è¿™é‡Œä¹Ÿè¦ä¿®æ”¹ä¸º categorical_crossentropy</span></span><br><span class="line">              optimizer=RMSprop(lr=<span class="number">0.001</span>),</span><br><span class="line">              metrics=[<span class="string">&#x27;acc&#x27;</span>])</span><br></pre></td></tr></table></figure>



<h2 id="Model-Fit-1"><a href="#Model-Fit-1" class="headerlink" title="Model Fit"></a><font color=MediumAquaMarine>Model Fit</font></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">history = model.fit(</span><br><span class="line">    train_generator, </span><br><span class="line">    epochs=<span class="number">25</span>, </span><br><span class="line">    steps_per_epoch=<span class="number">20</span>, </span><br><span class="line">    validation_data = validation_generator,</span><br><span class="line">    verbose = <span class="number">1</span>, </span><br><span class="line">    validation_steps=<span class="number">3</span>)</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200813122410.png" loading="lazy"></p>
<h1 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h1><h2 id="Week2-Exercise1"><a href="#Week2-Exercise1" class="headerlink" title="Â Week2 Exercise1Â "></a>Â Week2 Exercise1Â </h2><h3 id="Spilt-Data"><a href="#Spilt-Data" class="headerlink" title="Spilt Data"></a><font color=LightSalmon>Spilt Data</font></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">split_data</span>(<span class="params">SOURCE, TRAINING, TESTING, SPLIT_SIZE</span>):</span></span><br><span class="line"><span class="comment"># YOUR CODE STARTS HERE</span></span><br><span class="line">    dataset = []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> unitData <span class="keyword">in</span> os.listdir(SOURCE):</span><br><span class="line">        data = SOURCE + unitData	<span class="comment"># dataæŒ‡çš„æ˜¯æ¯ä¸ªæ–‡ä»¶çš„è·¯å¾„</span></span><br><span class="line">        <span class="keyword">if</span> (os.path.getsize(data) &gt; <span class="number">0</span>):	</span><br><span class="line">            dataset.append(unitData)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&#x27;Skipped &#x27;</span> + unitData)</span><br><span class="line">            print(<span class="string">&#x27;Invalid file size! i.e Zero length.&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    train_data_length = int(len(dataset) * SPLIT_SIZE)			<span class="comment"># è®­ç»ƒé›†å çš„å›¾ç‰‡æ•°é‡</span></span><br><span class="line">    test_data_length = int(len(dataset) - train_data_length)	<span class="comment"># æµ‹è¯•é›†å çš„å›¾ç‰‡æ•°é‡</span></span><br><span class="line">    shuffled_set = random.sample(dataset, len(dataset))</span><br><span class="line">    train_set = shuffled_set[<span class="number">0</span>:train_data_length]</span><br><span class="line">    test_set = shuffled_set[-test_data_length:]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> unitData <span class="keyword">in</span> train_set:</span><br><span class="line">        temp_train_data = SOURCE + unitData</span><br><span class="line">        final_train_data = TRAINING + unitData</span><br><span class="line">        copyfile(temp_train_data, final_train_data)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> unitData <span class="keyword">in</span> test_set:</span><br><span class="line">        temp_test_data = SOURCE + unitData</span><br><span class="line">        final_test_data = TESTING + unitData</span><br><span class="line">        copyfile(temp_train_data, final_test_data)</span><br><span class="line"><span class="comment"># YOUR CODE ENDS HERE</span></span><br><span class="line"></span><br><span class="line">CAT_SOURCE_DIR = <span class="string">&quot;/tmp/PetImages/Cat/&quot;</span></span><br><span class="line">TRAINING_CATS_DIR = <span class="string">&quot;/tmp/cats-v-dogs/training/cats/&quot;</span></span><br><span class="line">TESTING_CATS_DIR = <span class="string">&quot;/tmp/cats-v-dogs/testing/cats/&quot;</span></span><br><span class="line">DOG_SOURCE_DIR = <span class="string">&quot;/tmp/PetImages/Dog/&quot;</span></span><br><span class="line">TRAINING_DOGS_DIR = <span class="string">&quot;/tmp/cats-v-dogs/training/dogs/&quot;</span></span><br><span class="line">TESTING_DOGS_DIR = <span class="string">&quot;/tmp/cats-v-dogs/testing/dogs/&quot;</span></span><br><span class="line"></span><br><span class="line">split_size = <span class="number">.9</span></span><br><span class="line">split_data(CAT_SOURCE_DIR, TRAINING_CATS_DIR, TESTING_CATS_DIR, split_size)</span><br><span class="line">split_data(DOG_SOURCE_DIR, TRAINING_DOGS_DIR, TESTING_DOGS_DIR, split_size)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>è¾“å‡ºæ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> dirs = os.listdir( path ):</span><br><span class="line">	<span class="keyword">print</span> file</span><br></pre></td></tr></table></figure>
</li>
<li><p>è¿”å›æ–‡ä»¶å¤§å°ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨å°±è¿”å›é”™è¯¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.path.getsize(path)</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¸ºäº†æå–å‡ºNä¸ªä¸åŒå…ƒç´ çš„æ ·æœ¬ç”¨æ¥åšè¿›ä¸€æ­¥çš„æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨ <code>random.sample()</code> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>random.sample(values, <span class="number">2</span>)</span><br><span class="line">[<span class="number">6</span>, <span class="number">2</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>random.sample(values, <span class="number">2</span>)</span><br><span class="line">[<span class="number">4</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>random.sample(values, <span class="number">3</span>)</span><br><span class="line">[<span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>random.sample(values, <span class="number">3</span>)</span><br><span class="line">[<span class="number">5</span>, <span class="number">4</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä½ ä»…ä»…åªæ˜¯æƒ³æ‰“ä¹±åºåˆ—ä¸­å…ƒç´ çš„é¡ºåºï¼Œå¯ä»¥ä½¿ç”¨ <code>random.shuffle()</code> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>random.shuffle(values)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>values</span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">1</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>random.shuffle(values)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>values</span><br><span class="line">[<span class="number">3</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">4</span>]</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="Recap-1"><a href="#Recap-1" class="headerlink" title="Recap"></a><font color=LightCoral>Recap</font></h3><ul>
<li><input checked="" disabled="" type="checkbox"> ç»™æ¯ä¸ªå›¾ç‰‡æ–‡ä»¶æŒ‡å®šè·¯å¾„ <code>data = SOURCE + unitData</code></li>
<li><input checked="" disabled="" type="checkbox"> å¦‚æœå›¾ç‰‡æ–‡ä»¶å¤§å°å¤§äºé›¶ï¼Œå°±åŠ å…¥dataset   <code>os.path.getsize(path)</code></li>
<li><input checked="" disabled="" type="checkbox"> è®¡ç®—å‡ºè®­ç»ƒé›†å’Œæµ‹è¯•åˆ†åˆ«æ‰€å çš„å›¾ç‰‡æ•° <code>int(len(dataset)*SPLIT_SIZE)</code></li>
<li><input checked="" disabled="" type="checkbox"> æ‰“ä¹±æ•°æ®é›† <code>random.sample()</code>ï¼Œè¿™é‡Œå¯ä»¥ç”¨<code>random.shuffle</code>ä»£æ›¿</li>
<li><input checked="" disabled="" type="checkbox"> å°†æ•°æ®é›†åˆ†åˆ«åˆ†ç»™è®­ç»ƒé›†å’Œæµ‹è¯•é›† <code>[0:train_data_length]</code>ï¼Œ<code>[-test_data_length:]</code></li>
<li><input checked="" disabled="" type="checkbox"> å°†å›¾ç‰‡ä»Sourceæ–‡ä»¶å¤¹å¤åˆ¶åˆ°Trainingå’Œtestingæ–‡ä»¶å¤¹ä¸‹</li>
</ul>
<h3 id="Plot-loss-And-Accuracy"><a href="#Plot-loss-And-Accuracy" class="headerlink" title=" Plot loss And Accuracy"></a><font color=LightSalmon> Plot loss And Accuracy</font></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.image  <span class="keyword">as</span> mpimg</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">acc=history.history[<span class="string">&#x27;acc&#x27;</span>]</span><br><span class="line">val_acc=history.history[<span class="string">&#x27;val_acc&#x27;</span>]</span><br><span class="line">loss=history.history[<span class="string">&#x27;loss&#x27;</span>]</span><br><span class="line">val_loss=history.history[<span class="string">&#x27;val_loss&#x27;</span>]</span><br><span class="line"></span><br><span class="line">epochs=range(len(acc)) <span class="comment"># Get number of epochs</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#------------------------------------------------</span></span><br><span class="line"><span class="comment"># Plot training and validation accuracy per epoch</span></span><br><span class="line"><span class="comment">#------------------------------------------------</span></span><br><span class="line">plt.plot(epochs, acc, <span class="string">&#x27;r&#x27;</span>, <span class="string">&quot;Training Accuracy&quot;</span>)			<span class="comment"># æ¨ªè½´ã€çºµè½´ã€é¢œè‰²ã€label</span></span><br><span class="line">plt.plot(epochs, val_acc, <span class="string">&#x27;b&#x27;</span>, <span class="string">&quot;Validation Accuracy&quot;</span>) 	<span class="comment"># æ¨ªè½´ã€çºµè½´ã€é¢œè‰²ã€label</span></span><br><span class="line">plt.title(<span class="string">&#x27;Training and validation accuracy&#x27;</span>)</span><br><span class="line">plt.figure()</span><br><span class="line"></span><br><span class="line"><span class="comment">#------------------------------------------------</span></span><br><span class="line"><span class="comment"># Plot training and validation loss per epoch</span></span><br><span class="line"><span class="comment">#------------------------------------------------</span></span><br><span class="line">plt.plot(epochs, loss, <span class="string">&#x27;r&#x27;</span>, <span class="string">&quot;Training Loss&quot;</span>)</span><br><span class="line">plt.plot(epochs, val_loss, <span class="string">&#x27;b&#x27;</span>, <span class="string">&quot;Validation Loss&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">&#x27;Training and validation loss&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Desired output. Charts with training and validation metrics. No crash :)</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>æ˜¯<code>acc</code>è¿˜æ˜¯<code>accuracy</code>ï¼Œå–å†³äº<code>model.compile(optimizer=RMSprop(lr=0.001), loss=&#39;binary_crossentropy&#39;, metrics=[&#39;acc&#39;])</code> çš„è¿™ä¸ª<code>metrics</code>æ˜¯<code>acc</code>è¿˜æ˜¯<code>accuracy</code></p>
</li>
<li><p>è‰²å½©ï¼šæ”¯æŒçš„é¢œè‰²ç¼©å†™æ˜¯å•ä¸ªå­—æ¯ä»£ç </p>
<table>
<thead>
<tr>
<th>å­—ç¬¦</th>
<th>é¢œè‰²</th>
</tr>
</thead>
<tbody><tr>
<td><code>&#39;b&#39;</code></td>
<td>è“è‰²</td>
</tr>
<tr>
<td><code>&#39;g&#39;</code></td>
<td>ç»¿è‰²</td>
</tr>
<tr>
<td><code>&#39;r&#39;</code></td>
<td>çº¢</td>
</tr>
<tr>
<td><code>&#39;c&#39;</code></td>
<td>é’è‰²</td>
</tr>
<tr>
<td><code>&#39;m&#39;</code></td>
<td>å“çº¢</td>
</tr>
<tr>
<td><code>&#39;y&#39;</code></td>
<td>é»„è‰²</td>
</tr>
<tr>
<td><code>&#39;k&#39;</code></td>
<td>é»‘è‰²</td>
</tr>
<tr>
<td><code>&#39;w&#39;</code></td>
<td>ç™½è‰²</td>
</tr>
</tbody></table>
<p>æˆ–è€…è¿™æ ·ä¹Ÿå¯ä»¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">epochs=range(len(acc))</span><br><span class="line">plt.plot(epochs,acc)</span><br><span class="line">plt.plot(epochs,val_acc)</span><br><span class="line">plt.title(<span class="string">&#x27;Training and validation accuracy&#x27;</span>)</span><br><span class="line">plt.figure()</span><br><span class="line"></span><br><span class="line">plt.plot(epochs,loss )</span><br><span class="line">plt.plot(epochs,val_loss)</span><br><span class="line">plt.title(<span class="string">&#x27;Training and validation loss&#x27;</span>)</span><br><span class="line">plt.figure()</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h2 id="Week2-Exercise4"><a href="#Week2-Exercise4" class="headerlink" title="Week2 Exercise4"></a>Week2 Exercise4</h2><h3 id="Get-Data"><a href="#Get-Data" class="headerlink" title="Get Data"></a><font color=LightSalmon>Get Data</font></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_data</span>(<span class="params">filename</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">You will need to write code that will read the file passed into this function. The first line contains the column headers so you should ignore it. Each successive line contians 785 comma separated values between 0 and 255. The first value is the label.The rest are the pixel values for that picture.The function will return 2 np.array types. One with all the labels.One with all the images. Tips: If you read a full line (as &#x27;row&#x27;) then row[0] has the label,and row[1:785] has the 784 pixel values. Take a look at np.array_split to turn the 784 pixels into 28x28. You are reading in strings, but need the values to be floats.Check out np.array().astype for a conversion</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>    </span><br><span class="line">    <span class="keyword">with</span> open(filename) <span class="keyword">as</span> training_file:</span><br><span class="line">    <span class="comment"># Your code starts here</span></span><br><span class="line">        csv_reader = csv.reader(training_file, delimiter=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">        first_line = <span class="literal">True</span></span><br><span class="line">        temp_labels= []</span><br><span class="line">        temp_images = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> csv_reader:</span><br><span class="line">        <span class="comment"># Makes first iteration of loop for first row do nothing.</span></span><br><span class="line">        <span class="comment"># That&#x27;s how you skip the first row with headers.</span></span><br><span class="line">            <span class="keyword">if</span> first_line: </span><br><span class="line">                first_line = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                temp_labels.append(row[<span class="number">0</span>])</span><br><span class="line">                image_data = row[<span class="number">1</span>:<span class="number">785</span>] </span><br><span class="line">                image_array = np.array_split(image_data, <span class="number">28</span>) <span class="comment"># Make 28 x 28</span></span><br><span class="line">                temp_images.append(image_array)</span><br><span class="line">        </span><br><span class="line">        images = np.array(temp_images).astype(<span class="string">&#x27;float&#x27;</span>)</span><br><span class="line">        labels = np.array(temp_labels).astype(<span class="string">&#x27;float&#x27;</span>)</span><br><span class="line">      <span class="comment"># Your code ends here</span></span><br><span class="line">    <span class="keyword">return</span> images, labels</span><br><span class="line"></span><br><span class="line">path_sign_mnist_train = <span class="string">f&quot;<span class="subst">&#123;getcwd()&#125;</span>/../tmp2/sign_mnist_train.csv&quot;</span></span><br><span class="line">path_sign_mnist_test = <span class="string">f&quot;<span class="subst">&#123;getcwd()&#125;</span>/../tmp2/sign_mnist_test.csv&quot;</span></span><br><span class="line">training_images, training_labels = get_data(path_sign_mnist_train)</span><br><span class="line">testing_images, testing_labels = get_data(path_sign_mnist_test)</span><br><span class="line"></span><br><span class="line">print(training_images.shape)</span><br><span class="line">print(training_labels.shape)</span><br><span class="line">print(testing_images.shape)</span><br><span class="line">print(testing_labels.shape)</span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>with open() as</code>ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/MsSpark/article/details/86745391?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522159737196419195162501901%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=159737196419195162501901&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v3~pc_rank_v3-1-86745391.pc_ecpm_v3_pc_rank_v3&utm_term=with+open+as+f%E7%94%A8%E6%B3%95&spm=1018.2118.3001.4187">è¯¦æƒ…</a></p>
</li>
<li><p><code>csv_reader = csv.reader</code>ï¼šè¯»å–csvæ–‡ä»¶</p>
<p><code>Dialect.delimiter</code>ï¼šä¸€ä¸ªç”¨äºåˆ†éš”å­—æ®µçš„å•å­—ç¬¦å­—ç¬¦ä¸²ã€‚é»˜è®¤ä¸º<code>&#39;,&#39;</code>ã€‚</p>
</li>
<li><p><code>First_line</code>ç”¨äºè·³è¿‡ç¬¬ä¸€è¡Œï¼Œä¹Ÿå¯ä»¥ç”¨<code>   next(csv_reader, None)  # skip the headers</code></p>
<p>ç¬¬ä¸€è¡Œå¾€å¾€æ˜¯æ ‡é¢˜ï¼Œæ‰€ä»¥éœ€è¦è¢«è·³è¿‡</p>
</li>
<li><p><code>numpy.array_split </code>ï¼šå°†æ•°ç»„æ‹†åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„å¤šä¸ªå­æ•°ç»„</p>
</li>
<li><p><code>numpy.array(temp_array).astype()</code>ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/A632189007/article/details/77989287">æ•°æ®ç±»å‹è½¬æ¢</a></p>
</li>
</ul>
<p>CSVçš„æ–‡ä»¶åº”è¯¥æ˜¯ï¼š</p>
<table>
<thead>
<tr>
<th>æ ‡ç­¾ï¼ˆLabelï¼‰</th>
<th>åƒç´ å€¼1</th>
<th>åƒç´ å€¼2</th>
<th>â€¦</th>
<th>åƒç´ å€¼785</th>
</tr>
</thead>
<tbody><tr>
<td><code>row[1][0]</code> å›¾ç‰‡1</td>
<td><code>row[1][1]</code></td>
<td><code>row[1][2]</code></td>
<td>â€¦</td>
<td><code>row[1][785]</code></td>
</tr>
<tr>
<td><code>row[2][0]</code> å›¾ç‰‡2</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>â€¦</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>row[n][0]</code> å›¾ç‰‡n</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="Recap-2"><a href="#Recap-2" class="headerlink" title="Recap"></a><font color=LightCoral>Recap</font></h3><ul>
<li><input checked="" disabled="" type="checkbox"> æ‰“å¼€csvæ–‡ä»¶ <code>csv.reader()</code></li>
<li><input checked="" disabled="" type="checkbox"> è¯»å–csvæ–‡ä»¶æ¯ä¸€è¡Œï¼Œè®°å¾—è·³è¿‡ç¬¬ä¸€è¡Œ</li>
<li><input checked="" disabled="" type="checkbox"> æ¯ä¸€è¡Œçš„åŠ å…¥åˆ°<code>temp_labels</code>çš„æ•°æ®é›†ä¸­ï¼Œå‰©ä¸‹çš„å…¨æ˜¯<code>image_data</code>ï¼Œå†å°†<code>image_data</code>åˆ†æˆ28ä»½<code>image_array</code>ï¼Œæ¯ä¸€ä»½éƒ½åŠ å…¥åˆ°<code>temp_images</code>çš„æ•°æ®é›†ä¸­</li>
<li><input checked="" disabled="" type="checkbox"> æ›´æ”¹æ•°æ®ç±»å‹ï¼Œ<code>numpy.array(temp_array).astype()</code></li>
</ul>
<h3 id="Add-Dimensional"><a href="#Add-Dimensional" class="headerlink" title="Add Dimensional"></a><font color=LightSalmon>Add Dimensional</font></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># In this section you will have to add another dimension to the data</span></span><br><span class="line"><span class="comment"># So, for example, if your array is (10000, 28, 28)</span></span><br><span class="line"><span class="comment"># You will need to make it (10000, 28, 28, 1)</span></span><br><span class="line"><span class="comment"># Hint: np.expand_dims</span></span><br><span class="line"></span><br><span class="line">training_images = np.expand_dims(training_images, axis=<span class="number">-1</span>)</span><br><span class="line">testing_images =  np.expand_dims(testing_images, axis=<span class="number">-1</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>np.expand_dims</code>ï¼šå¢åŠ ä¸€ä¸ªç»´åº¦ã€‚axis=1ä»£è¡¨æ‰©å±•è¡Œï¼Œaxis=0ä»£è¡¨æ‰©å±•åˆ—,axis=-1ä»£è¡¨æ‰©å±•æœ€åä¸€ä¸ªå‚æ•°ã€‚<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_31829611/article/details/89293113?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.channel_param&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.channel_param">è¯¦æƒ…</a></p>
<p> ä½†æ˜¯ä¸ºå•¥è¦å¢åŠ ç»´åº¦å‘¢ï¼Ÿæˆ‘ä¹Ÿä¸çŸ¥é“ã€‚å•¥æ—¶å€™è§£å†³äº†è¿™ä¸ªé—®é¢˜æˆ‘å†æ¥å¡«å‘ã€‚</p>
</li>
</ul>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="Donate" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me money.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN@master/images/20210119090449.jpg"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN@master/images/20210119090449.jpg" alt="æ”¯ä»˜å®" title="æ”¯ä»˜å®"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN@master/images/20210119090448.png"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN@master/images/20210119090448.png" alt="QQ æ”¯ä»˜" title="QQ æ”¯ä»˜"></a><div><span style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN@master/images/20210119090450.png"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN@master/images/20210119090450.png" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡æ”¯ä»˜"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author: </strong>ç¨‹æµ·ç›</li><li class="post-copyright-link"><strong>Post link: </strong><a href="https://allmainashley.github.io/2020/09/30/Notes/Machine%20Learning/Tensorflow%20Convolutional%20Neural%20Networks/" title="Tensorflow å·ç§¯ç½‘ç»œ">https://allmainashley.github.io/2020/09/30/Notes/Machine%20Learning/Tensorflow%20Convolutional%20Neural%20Networks/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> unless otherwise stated.</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2020/09/30/Notes/Machine%20Learning/Tensorflow%20Nature%20Language%20Processing/" rel="prev" title="Tensorflow Natural Language Processing"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">Tensorflow Natural Language Processing</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2020/09/30/Notes/Machine%20Learning/Tensorflow%20Basic%20Programming/" rel="next" title="Tensorflow åŸºç¡€ç¼–ç¨‹"><span class="post-nav-text">Tensorflow åŸºç¡€ç¼–ç¨‹</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>è‹¥æ‚¨æ—  GitHub è´¦å·ï¼Œå¯ç›´æ¥åœ¨ä¸‹æ–¹åŒ¿åè¯„è®ºã€‚</span><br><span>è‹¥æ‚¨æƒ³åŠæ—¶å¾—åˆ°å›å¤æé†’ï¼Œå»ºè®®è·³è½¬ GitHub Issues è¯„è®ºã€‚</span><br><span>è‹¥æ²¡æœ‰æœ¬æ–‡ Issueï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Comment æ¨¡ç‰ˆæ–°å»ºã€‚</span><br><a class="hty-button hty-button--raised" id="github-issues" target="_blank" rel="noopener" href="https://github.com/AllMainAshley/AllMainAshley.github.io/issues?q=is:issue+Tensorflow å·ç§¯ç½‘ç»œ">GitHub Issues</a></div><div id="valine-container"></div><script>Yun.utils.getScript("https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js", () => {
  const valineConfig = {"enable":true,"appId":"duRJqtj9W4MnlhHrkhx0O3vb-gzGzoHsz","appKey":"7GxBY57ustzpxvpwNr39XneW","placeholder":"I want to say...","avatar":null,"pageSize":10,"visitor":false,"highlight":true,"recordIP":false,"enableQQ":true,"el":"#valine-container","lang":"en"}
  valineConfig.path = "/2020/09/30/Notes/Machine%20Learning/Tensorflow%20Convolutional%20Neural%20Networks/"
  new Valine(valineConfig)
}, window.Valine);</script></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2020 â€“ 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> ç¨‹æµ·ç›</span></div><div class="powered"><span>Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> v5.2.0</span><span class="footer-separator">|</span><span>Theme - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.6.1</span></div><div class="live_time"><span>æœ¬åšå®¢å·²èŒèŒå“’åœ°è¿è¡Œ</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2020-05-10T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " å¤© " + passHour + " å°æ—¶ " + passMinute + " åˆ† " + passSecond + " ç§’";
}
blog_live_time();
</script></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="Search"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="Searching..." value=""></div><div id="local-search-result"></div></div></div></body></html>