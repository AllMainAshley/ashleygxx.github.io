<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="ç¨‹æµ·ç›"><meta name="copyright" content="ç¨‹æµ·ç›"><meta name="generator" content="Hexo 5.2.0"><meta name="theme" content="hexo-theme-yun"><title>Tensorflow åŸºç¡€ç¼–ç¨‹ | Ashley</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.25/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.min.js"></script><script>document.addEventListener("DOMContentLoaded", () => {
  Yun.utils.renderKatex();
});</script><script src="https://cdn.jsdelivr.net/npm/pjax@latest/pjax.min.js" defer></script><script src="/js/pjax.js" defer></script><script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script><link rel="icon" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"allmainashley.github.io","root":"/","title":"ç›å§œè‘±èŠ±é±¼","version":"1.6.2","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.xml"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><link rel="alternate" href="/atom.xml" title="Ashley" type="application/atom+xml"><meta name="description" content="å‰è¨€æœºå™¨å­¦ä¹ å’Œä»¥å¾€çš„ç¼–ç¨‹çš„åŒºåˆ«ï¼š   What weâ€™ll do is we can get a bunch of examples from what we want to see, and then have the computer figure out the rules.  æ³¨æ„ï¼šæˆ‘ä»¬æ‰€æ‰“ä¸Šçš„æ ‡ç­¾ï¼ˆLabelsï¼‰æ˜¯Answersï¼Œè€Œä¸æ˜¯Rulesã€‚ Google Colabä¸Šçš„æ‰€æœ‰ä»£ç ">
<meta property="og:type" content="article">
<meta property="og:title" content="Tensorflow åŸºç¡€ç¼–ç¨‹">
<meta property="og:url" content="https://allmainashley.github.io/2020/09/30/Notes/Machine%20Learning/Tensorflow%20Basic%20Programming/index.html">
<meta property="og:site_name" content="Ashley">
<meta property="og:description" content="å‰è¨€æœºå™¨å­¦ä¹ å’Œä»¥å¾€çš„ç¼–ç¨‹çš„åŒºåˆ«ï¼š   What weâ€™ll do is we can get a bunch of examples from what we want to see, and then have the computer figure out the rules.  æ³¨æ„ï¼šæˆ‘ä»¬æ‰€æ‰“ä¸Šçš„æ ‡ç­¾ï¼ˆLabelsï¼‰æ˜¯Answersï¼Œè€Œä¸æ˜¯Rulesã€‚ Google Colabä¸Šçš„æ‰€æœ‰ä»£ç ">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200804141544.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200805232405.jpg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200806232259.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200805175355.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200805181004.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200805232408.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200805232406.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200805232409.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200805232407.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200806224653.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200806224709.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200807173717.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200807173729.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200807173750.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200807173806.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200807173839.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200807173931.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200807173948.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200807174030.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200807174043.png">
<meta property="article:published_time" content="2020-09-29T16:15:53.009Z">
<meta property="article:modified_time" content="2020-08-08T00:06:28.699Z">
<meta property="article:author" content="ç¨‹æµ·ç›">
<meta property="article:tag" content="Tensorflow">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200804141544.png"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="ç¨‹æµ·ç›"><img width="96" loading="lazy" src="/images/1.jpg" alt="ç¨‹æµ·ç›"><span class="site-author-status" title="Fall in love with lsh.">ğŸ’˜</span></a><div class="site-author-name"><a href="/about/">ç¨‹æµ·ç›</a></div><a class="site-name" href="/about/site.html">Ashley</a><sub class="site-subtitle">Face to new life and SAY HEY.</sub><div class="site-desciption">åšä¸ªå¿«ä¹çš„ç¬¨è›‹</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">21</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">10</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">22</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-clipboard-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/AllMainAshley" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:ashleyallmain@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a><a class="links-item hty-icon-button" href="/girls/" title="å–œæ¬¢çš„å¥³å­©å­" style="color:hotpink"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-women-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#The-%E2%80%98Hello-Word%E2%80%99-in-neural-networks"><span class="toc-number">2.</span> <span class="toc-text">The â€˜Hello Wordâ€™ in neural networks</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#The-complete-code"><span class="toc-number">2.1.</span> <span class="toc-text">The complete code</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Why-not-19%EF%BC%9F"><span class="toc-number">2.2.</span> <span class="toc-text">Why not 19ï¼Ÿ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Fashion-mnist"><span class="toc-number">3.</span> <span class="toc-text">Fashion mnist</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Choose-an-ankle-boot-picture%EF%BC%8Cits-label-is-09%EF%BC%8Cwhy-are-numbers%EF%BC%9F"><span class="toc-number">3.1.</span> <span class="toc-text"> Choose an ankle boot pictureï¼Œits label isÂ 09ï¼Œwhy are numbersï¼Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#The-complete-code-1"><span class="toc-number">3.2.</span> <span class="toc-text">The complete code</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Callback"><span class="toc-number">3.3.</span> <span class="toc-text">Callback</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Convolutional-neural-networks"><span class="toc-number">4.</span> <span class="toc-text">Convolutional neural networks</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#The-complete-code-2"><span class="toc-number">4.1.</span> <span class="toc-text">The complete code</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Visualizing-the-convolutions-and-pooling"><span class="toc-number">5.</span> <span class="toc-text">Visualizing the convolutions and pooling</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#The-complete-code-3"><span class="toc-number">5.1.</span> <span class="toc-text">The complete code</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Walking-through-convolutions"><span class="toc-number">6.</span> <span class="toc-text">Walking through convolutions</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#The-complete-code-4"><span class="toc-number">6.1.</span> <span class="toc-text">The complete code</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Conclusion"><span class="toc-number">6.1.1.</span> <span class="toc-text">Conclusion</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Image-Generator"><span class="toc-number">7.</span> <span class="toc-text">Image Generator</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#The-complete-code-5"><span class="toc-number">7.1.</span> <span class="toc-text">The complete code</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Data-Processing"><span class="toc-number">7.1.1.</span> <span class="toc-text">Data Processing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Training"><span class="toc-number">7.1.2.</span> <span class="toc-text">Training</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Running-the-model"><span class="toc-number">7.1.3.</span> <span class="toc-text">Running the model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Visualization"><span class="toc-number">7.1.4.</span> <span class="toc-text">Visualization</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://allmainashley.github.io/2020/09/30/Notes/Machine%20Learning/Tensorflow%20Basic%20Programming/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="ç¨‹æµ·ç›"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Ashley"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Tensorflow åŸºç¡€ç¼–ç¨‹</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="Created: 2020-09-30 00:15:53" itemprop="dateCreated datePublished" datetime="2020-09-30T00:15:53+08:00">2020-09-30</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="Modified: 2020-08-08 08:06:28" itemprop="dateModified" datetime="2020-08-08T08:06:28+08:00">2020-08-08</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="Word count in article"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="Word count in article">5.4k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Reading time"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="Reading time">28m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Notes/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Notes</span></a></span> > <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Notes/Machine-Learning/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Machine Learning</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/Tensorflow/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">Tensorflow</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœºå™¨å­¦ä¹ å’Œä»¥å¾€çš„ç¼–ç¨‹çš„åŒºåˆ«ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200804141544.png" loading="lazy"></p>
<blockquote>
<p>What weâ€™ll do is we can get a bunch of examples from what we want to see, and then have the computer figure out the rules.</p>
</blockquote>
<p><font color=LighSlateGray>æ³¨æ„ï¼šæˆ‘ä»¬æ‰€æ‰“ä¸Šçš„æ ‡ç­¾ï¼ˆLabelsï¼‰æ˜¯Answersï¼Œè€Œä¸æ˜¯Rulesã€‚</font></p>
<p><a target="_blank" rel="noopener" href="https://colab.research.google.com/github/lmoroney/dlaicourse/blob/master">Google Colabä¸Šçš„æ‰€æœ‰ä»£ç </a></p>
<h1 id="The-â€˜Hello-Wordâ€™-in-neural-networks"><a href="#The-â€˜Hello-Wordâ€™-in-neural-networks" class="headerlink" title="The â€˜Hello Wordâ€™ in neural networks"></a>The â€˜Hello Wordâ€™ in neural networks</h1><p><code>model = keras.Sequential([keras.layers.Dense(units=1,input_shape=[1])])</code></p>
<p><font color=DarkOrange>Denseï¼š define a layer of connected neurons </font></p>
<p><font color=DarkOrange>Sequencialï¼šSuccesiveï¼ˆè¿ç»­ä¸æ–­çš„ï¼‰ layer</font></p>
<hr>
<p><code>model.compile(optimizer=&#39;sgd&#39;,loss=&#39;mean_squared_error&#39;)</code></p>
<p><font color=DarkOrange>SGDï¼šStochastic Gradient Descentï¼ˆéšæœºæ¢¯åº¦ä¸‹é™ï¼‰</font></p>
<p><font color=DarkOrange>Mean Squared Errorï¼šå‡æ–¹è¯¯å·®</font></p>
<p>è¡¥å……èµ„æ–™ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/guoyaohua/p/8542554.html">æ·±åº¦å­¦ä¹ â€”â€”ä¼˜åŒ–å™¨ç®—æ³•Optimizerè¯¦è§£ï¼ˆBGDã€SGDã€MBGDã€Momentumã€NAGã€Adagradã€Adadeltaã€RMSpropã€Adamï¼‰</a></p>
<hr>
<p><code>xs = np.array([-1.0,0.0,1.0,2.0,3.0,4.0],dtype=float)</code><br><code>ys = np.array([-3.0,-1.0,1.0,3.0,5.0,7.0],dtype=float)</code></p>
<p><font color=DarkOrange>Xå’ŒYçš„å€¼</font></p>
<hr>
<p><code>model.fit(xs,ys,epochs=500)</code></p>
<p><font color=DarkOrange>ä»£å…¥åˆ›å»ºå¥½çš„æ¨¡å‹ä¸­ï¼Œè¿­ä»£500æ¬¡</font></p>
<hr>
<p><code>print(model.predict([10.0]))</code></p>
<p><font color=DarkOrange>å®Œæˆåï¼Œè¾“å…¥æ–°çš„æ•°æ®ï¼Œå¹¶è®©æ¨¡å‹é¢„æµ‹ç»“æœ</font></p>
<hr>
<p><font color=DarkOrange>æ‰“å°äº†500ä¸ªï¼Œæœ€åä¸€ä¸ªç»“æœæ˜¯</font></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6</span>/<span class="number">6</span> [==============================] - <span class="number">0</span>s <span class="number">492</span>us/step - loss: <span class="number">5.0427e-05</span></span><br><span class="line">[[<span class="number">18.979282</span>]]</span><br></pre></td></tr></table></figure>



<h2 id="The-complete-code"><a href="#The-complete-code" class="headerlink" title="The complete code"></a>The complete code</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">model = keras.Sequential([keras.layers.Dense(units=<span class="number">1</span>,input_shape=[<span class="number">1</span>])])</span><br><span class="line">model.compile(optimizer=<span class="string">&#x27;sgd&#x27;</span>,loss=<span class="string">&#x27;mean_squared_error&#x27;</span>)</span><br><span class="line"></span><br><span class="line">xs = np.array([<span class="number">-1.0</span>,<span class="number">0.0</span>,<span class="number">1.0</span>,<span class="number">2.0</span>,<span class="number">3.0</span>,<span class="number">4.0</span>],dtype=float)</span><br><span class="line">ys = np.array([<span class="number">-3.0</span>,<span class="number">-1.0</span>,<span class="number">1.0</span>,<span class="number">3.0</span>,<span class="number">5.0</span>,<span class="number">7.0</span>],dtype=float)</span><br><span class="line"></span><br><span class="line">model.fit(xs,ys,epochs=<span class="number">500</span>)</span><br><span class="line"></span><br><span class="line">print(model.predict([<span class="number">10.0</span>]))</span><br></pre></td></tr></table></figure>

<h2 id="Why-not-19ï¼Ÿ"><a href="#Why-not-19ï¼Ÿ" class="headerlink" title="Why not 19ï¼Ÿ"></a><font color=Red>Why not 19ï¼Ÿ</font></h2><ul>
<li><p>The first is that you trained it using a very little data. (æ•°æ®å°‘)</p>
</li>
<li><p>When using neural network, as they try to figure out the answer for everything, they deal in probability. (æ¦‚ç‡)</p>
</li>
</ul>
<h1 id="Fashion-mnist"><a href="#Fashion-mnist" class="headerlink" title="Fashion mnist"></a>Fashion mnist</h1><p>Fashion-MNISTåŒ…å«70kå¼ å›¾ç‰‡ï¼Œ10ç§è¡£ç‰©ï¼Œå¹¶ä¸”æ¯å¼ éƒ½æ˜¯28x28ç°åº¦å›¾åƒï¼ˆæ•°æ®é‡æ›´å°ï¼Œä½†äººçœ¼ä¾ç„¶å¯ä»¥è¯†åˆ«ï¼‰ã€‚</p>
<p>å®ƒæ˜¯åœ¨Tensorflowè¿™ä¸ªAPIä¸­çš„æ•°æ®é›†ã€‚</p>
<p><code>mnist = keras.datasets.fashion_mnist</code></p>
<p><font color=DarkOrange>Declare an object of  type MNIST ï¼ˆå£°æ˜å˜é‡ï¼‰</font> </p>
<hr>
<p><code>(training_images, training_labels), (test_images, test_labels) = mnist.load_data()</code></p>
<p><font color=DarkOrange>Loading it from the Keras database, and on this object, if we called <code>load_data</code> method, it will return 4 lists to us, <code>the training data </code>, <code>the training labels </code>, <code>the testing data</code> and  <code>the testing labels</code>. </font></p>
<p><font color=darkorange>è°ƒç”¨å‡½æ•°ï¼Œè¿”å›å››ä¸ªåˆ—è¡¨ï¼Œè®­ç»ƒé›†ï¼Œè®­ç»ƒé›†æ ‡ç­¾ï¼Œæµ‹è¯•é›†ï¼Œæµ‹è¯•é›†æ ‡ç­¾ã€‚</font></p>
<h2 id="Choose-an-ankle-boot-pictureï¼Œits-label-is-09ï¼Œwhy-are-numbersï¼Ÿ"><a href="#Choose-an-ankle-boot-pictureï¼Œits-label-is-09ï¼Œwhy-are-numbersï¼Ÿ" class="headerlink" title=" Choose an ankle boot pictureï¼Œits label isÂ 09ï¼Œwhy are numbersï¼Ÿ"></a><font color=Red> Choose an ankle boot pictureï¼Œits label isÂ <code>09</code>ï¼Œwhy are numbersï¼Ÿ</font></h2><ul>
<li><p>Computer do better with numbers  ï¼ˆè®¡ç®—æœºå¤„ç†æ•°å­—å¤„ç†åœ°æ›´å¥½ï¼‰</p>
</li>
<li><p>Reduce bias å‡å°‘åè§ã€‚å¦‚æœç”¨è‹±è¯­æ ‡æ³¨ï¼Œä¼šåå‘English Speakers. ï¼‰</p>
<p>ï¼ˆå•Šè¿™ï¼Œå¯æ˜¯ä¸»æµçš„ç¼–ç¨‹è¯­è¨€ä¸éƒ½æ˜¯ç”¨è‹±è¯­å†™çš„å˜›ã€‚ä½†æ˜¯æ¢æˆæ•°å­—ç¡®å®å…å»äº†è½¬æ¢çš„éº»çƒ¦ï¼‰</p>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200805232405.jpg" loading="lazy"></p>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">model = keras.Sequential([</span><br><span class="line">    keras.layers.Flatten(input_shape=(<span class="number">28</span>,<span class="number">28</span>)),  </span><br><span class="line">    keras.layers.Dense(<span class="number">128</span>, activation=tf.nn.relu),</span><br><span class="line">    keras.layers.Dense(<span class="number">10</span>,activation=tf.nn.softmax) </span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<p><font color=DarkOrange>ç¬¬ä¸€å±‚æ˜¯æ‰å¹³å±‚ï¼Œæ¯ä¸ªå›¾ç‰‡çš„åƒç´ æ˜¯28x28ï¼ŒæŠŠè¿™ä¸ª28x28çš„æ­£æ–¹å½¢å˜æˆä¸€ä¸ªç®€å•çš„ linear arrayã€‚</font></p>
<p>ä¸¾ä¸ªä¾‹å­ï¼šæŠŠè¿™ä¸ª (height, width, channel) çš„ä¸‰ç»´æ•°æ®å‹ç¼©æˆé•¿åº¦ä¸º (height Ã— width Ã— channel, 1) çš„ä¸€ç»´æ•°ç»„ã€‚</p>
<p><font color=DarkOrange>ç¬¬äºŒå±‚æ˜¯éšè—å±‚ï¼Œè¿™ä¸€å±‚æœ‰128ä¸ªç¥ç»å…ƒã€‚</font></p>
<p><font color=DarkOrange>#ç¬¬ä¸‰å±‚æ˜¯è¾“å‡ºå±‚ï¼Œå› ä¸ºæœ‰10ç§è¡£ç‰©ï¼Œæ‰€ä»¥å¾—åˆ°çš„åº”è¯¥æ˜¯10ä¸ªæ¦‚ç‡ï¼Œä¸”å’Œä¸º1ã€‚</font></p>
<hr>
<h2 id="The-complete-code-1"><a href="#The-complete-code-1" class="headerlink" title="The complete code"></a>The complete code</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> keras</span><br><span class="line"><span class="comment"># import matplotlib.pyplot as plt</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½æ•°æ®é›†</span></span><br><span class="line">mnist = keras.datasets.fashion_mnist</span><br><span class="line">(training_images, training_labels), (test_images, test_labels) = mnist.load_data()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å°ç¬¬0ä¸ªæ ·æœ¬çš„å€¼</span></span><br><span class="line">plt.imshow(training_images[<span class="number">0</span>])</span><br><span class="line">print(training_labels[<span class="number">0</span>])</span><br><span class="line">print(training_images[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®é¢„å¤„ç†</span></span><br><span class="line">training_images = training_images/<span class="number">255.0</span></span><br><span class="line">test_images = test_images/<span class="number">255.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹æ­å»º</span></span><br><span class="line">model = keras.Sequential([</span><br><span class="line">    keras.layers.Flatten(input_shape=(<span class="number">28</span>,<span class="number">28</span>)),  <span class="comment">#æ¯ä¸ªå›¾ç‰‡çš„åƒç´ æ˜¯28x28</span></span><br><span class="line">    keras.layers.Dense(<span class="number">128</span>, activation=tf.nn.relu),</span><br><span class="line">    keras.layers.Dense(<span class="number">10</span>,activation=tf.nn.softmax) <span class="comment">#å› ä¸ºæœ‰10ç§è¡£ç‰©ï¼Œæ‰€ä»¥åº”è¯¥å¾—åˆ°çš„æ˜¯ä»–ä»¬å„è‡ªçš„æ¦‚ç‡</span></span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹ç¼–è¯‘</span></span><br><span class="line">model.compile(optimizer=tf.compat.v1.train.AdamOptimizer(),loss=<span class="string">&#x27;sparse_categorical_crossentropy&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹æ‹Ÿåˆ</span></span><br><span class="line">model.fit(training_images,training_labels,epochs=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è¯„ä¼°</span></span><br><span class="line">model.evaluate(test_images,test_labels)</span><br></pre></td></tr></table></figure>

<h2 id="Callback"><a href="#Callback" class="headerlink" title="Callback"></a>Callback</h2><p>è°ƒç”¨ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ£€æŸ¥æŒ‡æ ‡ï¼Œå¦‚æœè¿™ä¸ªæŒ‡æ ‡åˆæ ¼çš„è¯ï¼Œä½ å¯ä»¥åœ¨è¯¥ç‚¹å–æ¶ˆè®­ç»ƒã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myCallback</span>(<span class="params">tf.keras.callbacks.Callback</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">on_epoch_end</span>(<span class="params">self, epoch, logs=&#123;&#125;</span>):</span>     <span class="comment"># åœ¨è¿­ä»£ç»“æŸæ—¶è°ƒç”¨</span></span><br><span class="line">        <span class="keyword">if</span>(logs.get(<span class="string">&#x27;loss&#x27;</span>)&lt;<span class="number">0.4</span>):</span><br><span class="line">            print(<span class="string">&quot;\nLoss is low so cancelling training!&quot;</span>)</span><br><span class="line">            self.model.stop_training = <span class="literal">True</span>  <span class="comment"># å¦‚æœloss&lt;0.4,å°±åœæ­¢è®­ç»ƒ</span></span><br></pre></td></tr></table></figure>



<p><code>callbacks = myCallback()</code></p>
<p><font color=DarkOrange>å®ä¾‹åŒ–åˆšåˆšåˆ›å»ºçš„ç±»</font></p>
<p><code>model.fit(training_images,training_labels,epochs=5,callbacks=[callbacks])</code></p>
<p><font color=DarkOrange>ä¿®æ”¹<code>model.fit </code>å‡½æ•°ï¼Œä½¿ç”¨å›è°ƒå‚æ•°ï¼Œå¹¶ä¼ é€’å®ƒçš„ç±»å®ä¾‹</font></p>
<p><font color=LightSlateGray>çœ‹çœ‹ç»“æœï¼š</font></p>
<p><code>60000/60000 [==============================] - 3s 42us/step - loss: 0.3787</code><br><code>Loss is low so cancelling training!</code></p>
<h1 id="Convolutional-neural-networks"><a href="#Convolutional-neural-networks" class="headerlink" title="Convolutional neural networks"></a>Convolutional neural networks</h1><p>ä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œï¼ˆç”¨æ»¤æ³¢å™¨éå†å›¾ç‰‡ï¼‰ä»£æ›¿é€å¼ ç…§ç‰‡é€ä¸ªåƒç´ éå†ã€‚</p>
<p><code>tf.keras.layers.Conv2D(64,(3,3),activation=&#39;relu&#39;,input_shape=(28,28,1))</code></p>
<p><font color=DarkOrange>Conv2Dï¼šç¬¬ä¸€å±‚æ˜¯å·ç§¯å±‚</font></p>
<p><font color=DarkOrange>(3,3)ï¼šè¿‡æ»¤å™¨çš„å¤§å°æ˜¯ 3x3</font></p>
<p><font color=DarkOrange>activation=â€™reluâ€™ï¼šæ¿€æ´»å‡½æ•°æ˜¯reluï¼Œæ„å‘³ç€è´Ÿå€¼å°†ä¼šè¢«æŠ›å¼ƒ</font></p>
<p><font color=DarkOrange>input_shape=(28,28,1)ï¼šè¾“å…¥å½¢çŠ¶å’Œä¹‹å‰ä¸€æ ·ï¼Œæ˜¯ 28x28ã€‚é¢å¤–çš„1ä¸ªæ„å‘³ç€æˆ‘ä»¬æ­£åœ¨ç”¨1ä¸ªå­—èŠ‚å»æ¥åŠ è®¡ç®—é¢œè‰²æ·±åº¦ï¼ˆcolor depthï¼‰ï¼Œå› ä¸ºæ˜¯ç°åº¦å›¾åƒï¼Œæ‰€ä»¥åªéœ€è¦1ä¸ªå­—èŠ‚ï¼ˆå¦‚æœæ˜¯å½©è‰²å›¾åƒï¼Œåˆ™éœ€è¦3ä¸ªå­—èŠ‚ï¼‰</font></p>
<hr>
<p><code>tf.keras.layers.MaxPooling2D(2,2),</code></p>
<p><font color=DarkOrange>MaxPooling2Dï¼šç¬¬äºŒå±‚æ˜¯æ± åŒ–å±‚ï¼Œæ–¹å¼æ˜¯æœ€å¤§å€¼æ± åŒ–ï¼Œå…¶å°ºå¯¸æ˜¯ 2x2</font></p>
<p>Â·Â·Â·å…¶ä½™ä¾æ­¤ç±»æ¨ã€‚</p>
<p>ç»è¿‡ä¸¤ä¸ªå·ç§¯å±‚å’Œä¸¤ä¸ªæ± åŒ–å±‚ä¹‹åï¼Œcontentç®€åŒ–äº†å¾ˆå¤šã€‚</p>
<hr>
<p><code>model.summary()</code></p>
<p><font color=DarkOrange>This allows you to inspect the layers of the model, and see the journey of the image through the convolutions. ï¼ˆæ‰“å°æ¨¡å‹æ¦‚è¿°ä¿¡æ¯ï¼‰</font></p>
<p>æ‰“å°ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Model: &quot;sequential&quot;</span><br><span class="line">_________________________________________________________________</span><br><span class="line">Layer (type)                 Output Shape              Param #   </span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">conv2d (Conv2D)              (None, 26, 26, 64)        640       </span><br><span class="line">_________________________________________________________________</span><br><span class="line">max_pooling2d (MaxPooling2D) (None, 13, 13, 64)        0         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv2d_1 (Conv2D)            (None, 11, 11, 64)        36928     </span><br><span class="line">_________________________________________________________________</span><br><span class="line">max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">flatten (Flatten)            (None, 1600)              0         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">dense (Dense)                (None, 128)               204928    </span><br><span class="line">_________________________________________________________________</span><br><span class="line">dense_1 (Dense)              (None, 10)                1290      </span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Total params: 243,786</span><br><span class="line">Trainable params: 243,786</span><br><span class="line">Non-trainable params: 0</span><br><span class="line">_________________________________________________________________</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„è¿™ä¸ªOutput Shapeï¼š</p>
<ul>
<li><p><font color=HotPink>è¾“å…¥å½¢çŠ¶ï¼š28Ã—28</font></p>
</li>
<li><p><font color=HotPink>ç¬¬ä¸€å±‚ï¼š28-3+1=26ï¼ˆå› ä¸ºæ˜¯validå¡«å…… ä¸” fliteræ˜¯3x3ï¼‰</font></p>
</li>
<li><p><font color=HotPink>ç¬¬äºŒå±‚ï¼š26Ã·2ï¼ˆMaxPoolingçš„å¤§å°æ˜¯2x2ï¼Œæ‰€ä»¥strideä¹Ÿæ˜¯2ï¼‰=13</font></p>
</li>
<li><p><font color=HotPink>ç¬¬ä¸‰å±‚ï¼š13-3+1=11ï¼ˆå› ä¸ºæ˜¯validå¡«å…… ä¸” fliteræ˜¯3x3ï¼‰</font></p>
</li>
<li><p><font color=HotPink>ç¬¬å››å±‚ï¼š11Ã·2=5Â·Â·Â·Â·Â·Â·1ï¼ˆMaxPoolingçš„å¤§å°æ˜¯2x2ï¼Œæ‰€ä»¥strideä¹Ÿæ˜¯2ï¼‰</font></p>
</li>
<li><p><font color=HotPink>ç¬¬äº”å±‚ï¼šæ‰å¹³åŒ–ï¼Œ5Ã—5Ã—64 = 1600</font></p>
</li>
<li><p><font color=HotPink>è¾“å‡ºå±‚ï¼šæœ‰10ä¸ªåˆ†ç±»ï¼Œæ‰€ä»¥è¾“å‡ºå±‚çš„å½¢çŠ¶æ˜¯10</font></p>
</li>
</ul>
<blockquote>
<p>è®¡ç®—å…¬å¼ï¼šn_wä¸n_håŒç†ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200806232259.png" loading="lazy"></p>
</blockquote>
<p>è®­ç»ƒé›†æœ€åä¸€è¡Œç»“æœï¼š</p>
<p><code>10000/10000 [==============================] - 2s 199us/sample - loss: 0.2787</code></p>
<p>æµ‹è¯•é›†æœ€åä¸€è¡Œç»“æœï¼š</p>
<p><code>10000/10000 [==============================] - 2s 199us/sample - loss: 0.2787</code></p>
<h2 id="The-complete-code-2"><a href="#The-complete-code-2" class="headerlink" title="The complete code"></a>The complete code</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯¼åŒ…</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> keras</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½æ•°æ®é›†</span></span><br><span class="line">mnist = keras.datasets.fashion_mnist</span><br><span class="line">(training_images, training_labels), (test_images, test_labels) = mnist.load_data()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®é¢„å¤„ç†</span></span><br><span class="line">training_images=training_images.reshape(<span class="number">60000</span>,<span class="number">28</span>,<span class="number">28</span>,<span class="number">1</span>)</span><br><span class="line">training_images=training_images/<span class="number">255.0</span></span><br><span class="line">test_images=test_images.reshape(<span class="number">10000</span>,<span class="number">28</span>,<span class="number">28</span>,<span class="number">1</span>)</span><br><span class="line">test_images=test_images/<span class="number">255.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹æ­å»º</span></span><br><span class="line">model = tf.keras.Sequential([</span><br><span class="line">    tf.keras.layers.Conv2D(<span class="number">64</span>,(<span class="number">3</span>,<span class="number">3</span>),activation=<span class="string">&#x27;relu&#x27;</span>,input_shape=(<span class="number">28</span>,<span class="number">28</span>,<span class="number">1</span>)),</span><br><span class="line">    tf.keras.layers.MaxPooling2D(<span class="number">2</span>,<span class="number">2</span>),</span><br><span class="line">    tf.keras.layers.Conv2D(<span class="number">64</span>,(<span class="number">3</span>,<span class="number">3</span>),activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    tf.keras.layers.MaxPool2D(<span class="number">2</span>,<span class="number">2</span>),</span><br><span class="line">    tf.keras.layers.Flatten(),</span><br><span class="line">    tf.keras.layers.Dense(<span class="number">128</span>,activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    tf.keras.layers.Dense(<span class="number">10</span>,activation=<span class="string">&#x27;softmax&#x27;</span>)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹ç¼–è¯‘</span></span><br><span class="line">model.compile(optimizer=<span class="string">&#x27;adam&#x27;</span>,loss=<span class="string">&#x27;sparse_categorical_crossentropy&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å°æ¨¡å‹æ¦‚è¿°ä¿¡æ¯</span></span><br><span class="line">model.summary()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹æ‹Ÿåˆ</span></span><br><span class="line">model.fit(training_images,training_labels,epochs=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è¯„ä¼°</span></span><br><span class="line">test_loss=model.evaluate(test_images,test_labels)</span><br></pre></td></tr></table></figure>



<h1 id="Visualizing-the-convolutions-and-pooling"><a href="#Visualizing-the-convolutions-and-pooling" class="headerlink" title="Visualizing the convolutions and pooling"></a>Visualizing the convolutions and pooling</h1><p>å¦‚æœæ˜¯æ‰“å°å¤šå¼ å›¾ç‰‡éœ€è¦åœ¨æœ€æœ«å°¾åŠ ä¸€ä¸ª<code>plt.show</code></p>
<h2 id="The-complete-code-3"><a href="#The-complete-code-3" class="headerlink" title="The complete code"></a>The complete code</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯¼åŒ…</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½æ•°æ®é›†</span></span><br><span class="line">mnist = keras.datasets.fashion_mnist</span><br><span class="line">(training_images, training_labels), (test_images, test_labels) = mnist.load_data()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­å»ºæ¨¡å‹</span></span><br><span class="line">model = tf.keras.Sequential([</span><br><span class="line">    tf.keras.layers.Conv2D(<span class="number">64</span>,(<span class="number">3</span>,<span class="number">3</span>),activation=<span class="string">&#x27;relu&#x27;</span>,input_shape=(<span class="number">28</span>,<span class="number">28</span>,<span class="number">1</span>)),</span><br><span class="line">    tf.keras.layers.MaxPooling2D(<span class="number">2</span>,<span class="number">2</span>),</span><br><span class="line">    tf.keras.layers.Conv2D(<span class="number">64</span>,(<span class="number">3</span>,<span class="number">3</span>),activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    tf.keras.layers.MaxPool2D(<span class="number">2</span>,<span class="number">2</span>),</span><br><span class="line">    tf.keras.layers.Flatten(),</span><br><span class="line">    tf.keras.layers.Dense(<span class="number">128</span>,activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    tf.keras.layers.Dense(<span class="number">10</span>,activation=<span class="string">&#x27;softmax&#x27;</span>)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">print(test_labels[:<span class="number">100</span>])    <span class="comment"># æ‰“å°å‡ºå‰100ä¸ªæ ‡ç­¾</span></span><br><span class="line">f, axarr = plt.subplots(<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">FIRST_IMAGE=<span class="number">0</span></span><br><span class="line">SECOND_IMAGE=<span class="number">23</span></span><br><span class="line">THIRD_IMAGE=<span class="number">28</span></span><br><span class="line">CONVOLUTION_NUMBER=<span class="number">1</span></span><br><span class="line">layer_outputs = [layer.output <span class="keyword">for</span> layer <span class="keyword">in</span> model.layers]</span><br><span class="line">activation_model = tf.keras.models.Model(inputs = model.input, outputs = layer_outputs)</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">4</span>):  </span><br><span class="line">  f1 = activation_model.predict(test_images[FIRST_IMAGE].reshape(<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>))[x]</span><br><span class="line">  axarr[<span class="number">0</span>,x].imshow(f1[<span class="number">0</span>, : , :, CONVOLUTION_NUMBER], cmap=<span class="string">&#x27;inferno&#x27;</span>)</span><br><span class="line">  axarr[<span class="number">0</span>,x].grid(<span class="literal">False</span>)</span><br><span class="line">  f2 = activation_model.predict(test_images[SECOND_IMAGE].reshape(<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>))[x]</span><br><span class="line">  axarr[<span class="number">1</span>,x].imshow(f2[<span class="number">0</span>, : , :, CONVOLUTION_NUMBER], cmap=<span class="string">&#x27;inferno&#x27;</span>)</span><br><span class="line">  axarr[<span class="number">1</span>,x].grid(<span class="literal">False</span>)</span><br><span class="line">  f3 = activation_model.predict(test_images[THIRD_IMAGE].reshape(<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>))[x]</span><br><span class="line">  axarr[<span class="number">2</span>,x].imshow(f3[<span class="number">0</span>, : , :, CONVOLUTION_NUMBER], cmap=<span class="string">&#x27;inferno&#x27;</span>)</span><br><span class="line">  axarr[<span class="number">2</span>,x].grid(<span class="literal">False</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200805175355.png" loading="lazy"></p>
<h1 id="Walking-through-convolutions"><a href="#Walking-through-convolutions" class="headerlink" title="Walking through convolutions"></a>Walking through convolutions</h1><blockquote>
<p>è¡¥å……èµ„æ–™ï¼š</p>
<p>å®‰è£…cv2ï¼š<code>pip install opencv-python</code></p>
<p>ç½‘é€Ÿé—®é¢˜å¯ä»¥è¯•è¯•é•œåƒï¼š<code>pip install -i https://pypi.tuna.tsinghua.edu.cn/simple opencv-python</code></p>
<p>miscæ¨¡å—ï¼Œæä¾›ä¸€äº›åŸºæœ¬çš„å›¾åƒç›¸å…³çš„è¯»å†™å‡½æ•°ï¼Œå¯ä»¥å¾ˆè½»æ¾çš„è¯»å–æœ¬åœ°å›¾åƒæ–‡ä»¶åˆ°Pythonç¨‹åºé‡Œï¼Œä¹Ÿå¯å°†æ•°æ®è¾“å‡ºåˆ°å›¾åƒæ–‡ä»¶ã€‚miscæ¨¡å—è‡ªå¸¦ä¸€äº›ç°åº¦å›¾åƒascentå’Œå½©è‰²çš„faceå›¾ï¼Œå¯ä»¥scipy.misc.ascent()ç›´æ¥è·å–çˆ¬æ¥¼æ¢¯ascentå›¾æ•°æ®åˆ°Pythonç¨‹åºé‡Œï¼Œç”¨scipy.misc.face()è·å–ä¸€å‰¯ raccoonæµ£ç†Šfaceå›¾ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°çš„è¿”å›å€¼éƒ½æ˜¯Numpyçš„ndarrayæ•°ç»„ã€‚ faceå›¾åƒæ˜¯ä¸ªå½©è‰²å›¾åƒï¼Œå…¶æ•°æ®æ˜¯ä¸ªä¸‰ç»´æ•°ç»„ï¼Œæ˜¯ä¸ª1024x768çš„å›¾åƒï¼Œè€Œå›¾åƒä¸­æ¯ä¸ªåƒç´ çš„å€¼åˆæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåˆ†åˆ«å¯¹åº”è¯¥åƒç´ é¢œè‰²çš„çº¢ã€ç»¿ã€è“åˆ†é‡ã€‚ascentå›¾åƒæ˜¯ä¸ªç°åº¦å›¾åƒï¼Œå…¶æ•°æ®æ˜¯ä¸ªäºŒç»´æ•°ç»„ï¼Œåˆ†åˆ«å¯¹åº”å›¾åƒä¸­æ¯ä¸ªåƒç´ çš„ç°åº¦å€¼ã€‚<a target="_blank" rel="noopener" href="http://liao.cpython.org/scipy02/">è¯¦æƒ…</a></p>
<p>plt.imshow()å‡½æ•°è´Ÿè´£å¯¹å›¾åƒè¿›è¡Œå¤„ç†ï¼Œå¹¶æ˜¾ç¤ºå…¶æ ¼å¼ï¼Œä½†æ˜¯ä¸èƒ½æ˜¾ç¤ºã€‚å…¶åè·Ÿç€plt.show()æ‰èƒ½æ˜¾ç¤ºå‡ºæ¥ã€‚<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_39938666/article/details/85786413">è¯¦æƒ…</a></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> misc</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">i=misc.ascent() <span class="comment"># ç°åº¦å›¾åƒ</span></span><br><span class="line">plt.grid(<span class="literal">False</span>) <span class="comment"># ç”Ÿæˆç½‘ç»œ</span></span><br><span class="line">plt.gray() <span class="comment"># ç°åº¦å›¾åƒ</span></span><br><span class="line">plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">plt.imshow(i)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># æ­¤æ—¶å›¾åƒè¢«å­˜å‚¨ä¸ºnumpy array</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200805181004.png" loading="lazy"></p>
<h2 id="The-complete-code-4"><a href="#The-complete-code-4" class="headerlink" title="The complete code"></a>The complete code</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯¼åŒ…</span></span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> misc</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½æ•°æ®</span></span><br><span class="line">i=misc.ascent() <span class="comment"># ç°åº¦å›¾åƒ</span></span><br><span class="line">plt.grid(<span class="literal">False</span>) <span class="comment"># ç”Ÿæˆç½‘ç»œ</span></span><br><span class="line">plt.gray()      <span class="comment"># ç°åº¦å›¾åƒ</span></span><br><span class="line">plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">plt.imshow(i)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line">i_trainsformed = np.copy(i) 		<span class="comment"># æ­¤æ—¶å›¾åƒè¢«å­˜å‚¨ä¸ºnumpy array</span></span><br><span class="line">size_x = i_trainsformed.shape[<span class="number">0</span>]	<span class="comment"># size_x:ç¬¬0ç»´çš„é•¿åº¦</span></span><br><span class="line">size_y = i_trainsformed.shape[<span class="number">1</span>] 	<span class="comment"># size_y:ç¬¬1ç»´çš„é•¿åº¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„é€ ä¸€ä¸ª3Ã—3çš„filterï¼Œä»¥ä¸‹æ˜¯ä¸‰ç§ä¸åŒçš„filter</span></span><br><span class="line"><span class="comment"># filter = [[0,1,0],[1,-4,1],[0,1,0]]</span></span><br><span class="line"><span class="comment"># filter = [[-1,-2,-1],[0,0,0],[1,2,1]]</span></span><br><span class="line">filter = [[<span class="number">-1</span>,<span class="number">0</span>,<span class="number">1</span>],[<span class="number">-2</span>,<span class="number">0</span>,<span class="number">2</span>],[<span class="number">-1</span>,<span class="number">0</span>,<span class="number">1</span>]]</span><br><span class="line">weight = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„å»ºå·ç§¯ç¥ç»ç½‘ç»œï¼Œæ³¨æ„xå’Œyçš„èŒƒå›´</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>,size_x<span class="number">-1</span>):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">1</span>,size_y<span class="number">-1</span>):</span><br><span class="line">        convolution = <span class="number">0.0</span></span><br><span class="line">        convolution = convolution + (i[x<span class="number">-1</span>,y<span class="number">-1</span>] * filter[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">        convolution = convolution + (i[x,y<span class="number">-1</span>] * filter[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line">        convolution = convolution + (i[x+<span class="number">1</span>,y<span class="number">-1</span>] * filter[<span class="number">0</span>][<span class="number">2</span>])</span><br><span class="line">        convolution = convolution + (i[x<span class="number">-1</span>,y] * filter[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line">        convolution = convolution + (i[x,y] * filter[<span class="number">1</span>][<span class="number">1</span>])</span><br><span class="line">        convolution = convolution + (i[x+<span class="number">1</span>,y] * filter[<span class="number">1</span>][<span class="number">2</span>])</span><br><span class="line">        convolution = convolution + (i[x<span class="number">-1</span>,y+<span class="number">1</span>] * filter[<span class="number">2</span>][<span class="number">0</span>])</span><br><span class="line">        convolution = convolution + (i[x,y+<span class="number">1</span>] * filter[<span class="number">2</span>][<span class="number">1</span>])</span><br><span class="line">        convolution = convolution + (i[x+<span class="number">1</span>,y+<span class="number">1</span>] * filter[<span class="number">2</span>][<span class="number">2</span>])</span><br><span class="line">        <span class="comment"># reluå±‚ï¼š</span></span><br><span class="line">        <span class="keyword">if</span>(convolution&lt;<span class="number">0</span>):</span><br><span class="line">            convolution=<span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span>(convolution&gt;<span class="number">255</span>):</span><br><span class="line">            convolution=<span class="number">255</span></span><br><span class="line">        i_trainsformed[x,y]=convolution</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å°å·ç§¯åŒ–åçš„å›¾ç‰‡</span></span><br><span class="line">plt.grid(<span class="literal">False</span>)</span><br><span class="line">plt.gray()</span><br><span class="line">plt.imshow(i_trainsformed)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ± åŒ–</span></span><br><span class="line">new_x = int(size_x/<span class="number">2</span>)</span><br><span class="line">new_y = int(size_y/<span class="number">2</span>)</span><br><span class="line">newImage = np.zeros((new_x,new_y))</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>,size_x,<span class="number">2</span>):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">0</span>,size_y,<span class="number">2</span>):</span><br><span class="line">        pixels = []</span><br><span class="line">        pixels.append(i_trainsformed[x,y])</span><br><span class="line">        pixels.append(i_trainsformed[x+<span class="number">1</span>,y])</span><br><span class="line">        pixels.append(i_trainsformed[x,y+<span class="number">1</span>])</span><br><span class="line">        pixels.append(i_trainsformed[x+<span class="number">1</span>,y+<span class="number">1</span>])</span><br><span class="line">        pixels.sort(reverse=<span class="literal">True</span>)</span><br><span class="line">        newImage[int(x/<span class="number">2</span>),int(y/<span class="number">2</span>)] = pixels[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å°æ± åŒ–åçš„å›¾ç‰‡</span></span><br><span class="line">plt.grid(<span class="literal">False</span>)</span><br><span class="line">plt.gray()</span><br><span class="line">plt.imshow(i_trainsformed)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>ä¸åŒ<code>filter</code>å¯¹åº”çš„ç»“æœæŒ‰é¡ºåºå¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200805232408.png" loading="lazy"></p>
<p><font color=Salmon>ç¬¬ä¸€ä¸ªï¼šæ•ˆæœå¹¶ä¸æ˜æ˜¾</font></p>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200805232406.png" loading="lazy"></p>
<p><font color=Salmon>ç¬¬äºŒä¸ªï¼šæ£€æµ‹å‚ç›´è¾¹ç¼˜</font></p>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200805232409.png" loading="lazy"></p>
<p><font color=Salmon>ç¬¬ä¸‰ä¸ªï¼šæ£€æµ‹æ°´å¹³è¾¹ç¼˜</font></p>
<hr>
<p>æ± åŒ–ç»“æœï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200805232407.png" loading="lazy"></p>
<p><font color=Salmon>ä»åæ ‡è½´æ¥çœ‹ï¼Œè¿™äº›è¢«ä¿ç•™çš„ç‰¹å¾æ›´åŠ ç´§å¯†ï¼Œæˆ‘ç”¨çš„æ˜¯ç¬¬ä¸‰ä¸ªfilterï¼Œä½ ä¹Ÿå¯ä»¥è¯•è¯•åˆ«çš„filterã€‚</font></p>
<p><font color=Salmon>ï¼ˆå› ä¸ºæ± åŒ–çš„ç¼˜æ•…ï¼Œåªä¿ç•™äº†å›¾ç‰‡çš„éƒ¨åˆ†ç‰¹å¾ï¼Œæ‰€ä»¥è¿™ä¸ªå›¾å˜ç³Šäº†ï¼‰</font></p>
<hr>
<h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h3><p><font color=green><strong>é€šè¿‡å·ç§¯å’Œæ± åŒ–ï¼Œå¤§å¤§å‡å°‘äº†é€šè¿‡ç¥ç»ç½‘ç»œçš„ä¿¡æ¯ã€‚é€šè¿‡åˆ†ç¦»å’Œè¯†åˆ«ç‰¹å¾ï¼Œä½ è¿˜èƒ½å¾—åˆ°æ›´é«˜çš„ç²¾åº¦</strong></font></p>
<h1 id="Image-Generator"><a href="#Image-Generator" class="headerlink" title="Image Generator"></a>Image Generator</h1><blockquote>
<p>Image Generator æ˜¯tensorflowçš„ä¸€ä¸ªAPIã€‚ä½ å¯ä»¥æŠŠå®ƒæŒ‡å‘ä¸€ä¸ªç›®å½•ï¼Œç„¶åå®ƒçš„å­ç›®å½•ä¼šä¼šä¸ºä½ è‡ªåŠ¨ç”Ÿæˆæ ‡ç­¾ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘è¿™ä¸ªç›®å½•ç»“æ„ï¼Œä½ æœ‰ä¸€ä¸ªå›¾ç‰‡ç›®å½•ï¼Œæœ‰è®­ç»ƒå’ŒéªŒè¯é›†çš„å­ç›®å½•ï¼Œå½“ä½ æŠŠäººå’Œé©¬çš„å­ç›®å½•æ”¾åœ¨è¿™äº›çˆ¶ç›®å½•ä¸­ï¼Œå¹¶ä¸”å­˜å‚¨ç›¸åº”çš„å›¾åƒæ—¶ï¼ŒImage Generatorå¯ä»¥ä¸ºè¿™äº›å›¾ç‰‡åˆ›å»ºä¸€ä¸ªfeederï¼Œå¹¶ä¸”ä¸ºä½ è‡ªåŠ¨æ ‡è®°ã€‚<a target="_blank" rel="noopener" href="https://blog.csdn.net/mieleizhi0522/article/details/82191331">ç›¸å…³èµ„æ–™</a></p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200806224653.png" loading="lazy"></p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200806224709.png" loading="lazy"></p>
<hr>
<h2 id="The-complete-code-5"><a href="#The-complete-code-5" class="headerlink" title="The complete code"></a>The complete code</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://colab.research.google.com/drive/1ah5ni6r2PHMpn6ytttWrRY6AyCFk9N-j#scrollTo=RXZT2UsyIVe">å®Œæ•´ä»£ç  Goolgle Colabç‰ˆ</a> </p>
<p><a target="_blank" rel="noopener" href="https://storage.googleapis.com/laurencemoroney-blog.appspot.com/horse-or-human.zip">è®­ç»ƒé›†ä¸‹è½½</a></p>
<p><a target="_blank" rel="noopener" href="https://storage.googleapis.com/laurencemoroney-blog.appspot.com/validation-horse-or-human.zip">éªŒè¯é›†ä¸‹è½½</a></p>
<p><font color=Red><strong>å»ºè®®åœ¨Google Colabä¸Šè¿è¡Œ</strong></font></p>
</blockquote>
<h3 id="Data-Processing"><a href="#Data-Processing" class="headerlink" title="Data Processing"></a>Data Processing</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### è§£å‹æ•°æ®é›†</span></span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"></span><br><span class="line">local_zip = <span class="string">&#x27;/tmp/horse-or-human.zip&#x27;</span></span><br><span class="line">zip_ref = zipfile.ZipFile(local_zip, <span class="string">&#x27;r&#x27;</span>)			 <span class="comment"># ç”¨äºè¯»å†™ZIPæ–‡ä»¶çš„ç±»</span></span><br><span class="line">zip_ref.extractall(<span class="string">&#x27;/tmp/horse-or-human&#x27;</span>) 			 <span class="comment"># å°†å­˜æ¡£ä¸­çš„æ‰€æœ‰æˆå‘˜æå–åˆ°å½“å‰å·¥ä½œç›®å½•</span></span><br><span class="line">local_zip = <span class="string">&#x27;/tmp/validation-horse-or-human.zip&#x27;</span></span><br><span class="line">zip_ref = zipfile.ZipFile(local_zip, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">zip_ref.extractall(<span class="string">&#x27;/tmp/validation-horse-or-human&#x27;</span>) <span class="comment"># å°†å­˜æ¡£ä¸­çš„æ‰€æœ‰æˆå‘˜æå–åˆ°å½“å‰å·¥ä½œç›®å½•</span></span><br><span class="line">zip_ref.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Directory with our training horse pictures</span></span><br><span class="line">train_horse_dir = os.path.join(<span class="string">&#x27;horse-or-human/horses&#x27;</span>)</span><br><span class="line"><span class="comment"># Directory with our training human pictures</span></span><br><span class="line">train_human_dir = os.path.join(<span class="string">&#x27;horse-or-human/humans&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Directory with our training horse pictures</span></span><br><span class="line">validation_horse_dir = os.path.join(<span class="string">&#x27;/tmp/validation-horse-or-human/horses&#x27;</span>)</span><br><span class="line"><span class="comment"># Directory with our training human pictures</span></span><br><span class="line">validation_human_dir = os.path.join(<span class="string">&#x27;/tmp/validation-horse-or-human/humans&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">### æ‰“å°å‰10ä¸ªå›¾ç‰‡å</span></span><br><span class="line">train_horse_names = os.listdir(train_horse_dir)     <span class="comment"># ç”¨äºè¿”å›æŒ‡å®šçš„æ–‡ä»¶å¤¹åŒ…å«çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„åå­—çš„åˆ—è¡¨ã€‚</span></span><br><span class="line">print(train_horse_names[:<span class="number">10</span>])</span><br><span class="line">train_human_names = os.listdir(train_human_dir)</span><br><span class="line">print(train_human_names[:<span class="number">10</span>])</span><br><span class="line"></span><br><span class="line">validation_horse_hames = os.listdir(validation_horse_dir)</span><br><span class="line">print(validation_horse_hames[:<span class="number">10</span>])</span><br><span class="line">validation_human_names = os.listdir(validation_human_dir)</span><br><span class="line">print(validation_human_names[:<span class="number">10</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">### æ‰“å°å›¾ç‰‡æ€»æ•°é‡</span></span><br><span class="line">print(<span class="string">&#x27;total training horse images:&#x27;</span>, len(os.listdir(train_horse_dir)))</span><br><span class="line">print(<span class="string">&#x27;total training human images:&#x27;</span>, len(os.listdir(train_human_dir)))</span><br><span class="line">print(<span class="string">&#x27;total validation horse images:&#x27;</span>, len(os.listdir(validation_horse_dir)))</span><br><span class="line">print(<span class="string">&#x27;total validation human images:&#x27;</span>, len(os.listdir(validation_human_dir)))</span><br><span class="line"></span><br><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> matplotlib.image <span class="keyword">as</span> mpimg</span><br><span class="line"><span class="comment"># Parameters for our graph; we&#x27;ll output images in a 4x4 configuration</span></span><br><span class="line">nrows = <span class="number">4</span></span><br><span class="line">ncols = <span class="number">4</span></span><br><span class="line"><span class="comment"># Index for iterating over images</span></span><br><span class="line">pic_index = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">### éšæœºç”Ÿæˆå›¾ç‰‡</span></span><br><span class="line"><span class="comment"># Set up matplotlib fig, and size it to fit 4x4 pics</span></span><br><span class="line">fig = plt.gcf() <span class="comment"># è·å–å½“å‰æ•°å­—ã€‚å¦‚æœæ²¡æœ‰å½“å‰æ•°å­—ï¼Œåˆ™ä½¿ç”¨åˆ›å»ºä¸€ä¸ªæ–°æ•°å­— figure()ã€‚</span></span><br><span class="line">fig.set_size_inches(ncols * <span class="number">4</span>, nrows * <span class="number">4</span>)   <span class="comment"># ä»¥è‹±å¯¸ä¸ºå•ä½è®¾ç½®å›¾å½¢å°ºå¯¸</span></span><br><span class="line"></span><br><span class="line">pic_index += <span class="number">8</span></span><br><span class="line">next_horse_pix = [os.path.join(train_horse_dir, fname) </span><br><span class="line">                <span class="keyword">for</span> fname <span class="keyword">in</span> train_horse_names[pic_index<span class="number">-8</span>:pic_index]]</span><br><span class="line">next_human_pix = [os.path.join(train_human_dir, fname) </span><br><span class="line">                <span class="keyword">for</span> fname <span class="keyword">in</span> train_human_names[pic_index<span class="number">-8</span>:pic_index]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, img_path <span class="keyword">in</span> enumerate(next_horse_pix+next_human_pix):</span><br><span class="line">  <span class="comment"># Set up subplot; subplot indices start at 1</span></span><br><span class="line">  sp = plt.subplot(nrows, ncols, i + <span class="number">1</span>)</span><br><span class="line">  sp.axis(<span class="string">&#x27;Off&#x27;</span>) <span class="comment"># Don&#x27;t show axes (or gridlines)</span></span><br><span class="line"></span><br><span class="line">  img = mpimg.imread(img_path)</span><br><span class="line">  plt.imshow(img)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment">### æ­å»ºæ¨¡å‹</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line">model = tf.keras.models.Sequential([</span><br><span class="line">    <span class="comment"># Note the input shape is the desired size of the image 300x300 with 3 bytes color</span></span><br><span class="line">    <span class="comment"># This is the first convolution</span></span><br><span class="line">    tf.keras.layers.Conv2D(<span class="number">16</span>, (<span class="number">3</span>,<span class="number">3</span>), activation=<span class="string">&#x27;relu&#x27;</span>, input_shape=(<span class="number">300</span>, <span class="number">300</span>, <span class="number">3</span>)),</span><br><span class="line">    tf.keras.layers.MaxPooling2D(<span class="number">2</span>, <span class="number">2</span>),</span><br><span class="line">    <span class="comment"># The second convolution</span></span><br><span class="line">    tf.keras.layers.Conv2D(<span class="number">32</span>, (<span class="number">3</span>,<span class="number">3</span>), activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    tf.keras.layers.MaxPooling2D(<span class="number">2</span>,<span class="number">2</span>),</span><br><span class="line">    <span class="comment"># The third convolution</span></span><br><span class="line">    tf.keras.layers.Conv2D(<span class="number">64</span>, (<span class="number">3</span>,<span class="number">3</span>), activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    tf.keras.layers.MaxPooling2D(<span class="number">2</span>,<span class="number">2</span>),</span><br><span class="line">    <span class="comment"># The fourth convolution</span></span><br><span class="line">    tf.keras.layers.Conv2D(<span class="number">64</span>, (<span class="number">3</span>,<span class="number">3</span>), activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    tf.keras.layers.MaxPooling2D(<span class="number">2</span>,<span class="number">2</span>),</span><br><span class="line">    <span class="comment"># The fifth convolution</span></span><br><span class="line">    tf.keras.layers.Conv2D(<span class="number">64</span>, (<span class="number">3</span>,<span class="number">3</span>), activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    tf.keras.layers.MaxPooling2D(<span class="number">2</span>,<span class="number">2</span>),</span><br><span class="line">    <span class="comment"># Flatten the results to feed into a DNN</span></span><br><span class="line">    tf.keras.layers.Flatten(),</span><br><span class="line">    <span class="comment"># 512 neuron hidden layer</span></span><br><span class="line">    tf.keras.layers.Dense(<span class="number">512</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    <span class="comment"># Only 1 output neuron. It will contain a value from 0-1 where 0 for 1 class (&#x27;horses&#x27;) and 1 for the other (&#x27;humans&#x27;)</span></span><br><span class="line">    tf.keras.layers.Dense(<span class="number">1</span>, activation=<span class="string">&#x27;sigmoid&#x27;</span>)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment">### æ‰“å°æ¨¡å‹æ¦‚è¿°ä¿¡æ¯</span></span><br><span class="line">model.summary()</span><br><span class="line"></span><br><span class="line"><span class="comment">### ç¼–è¯‘æ¨¡å‹</span></span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.optimizers <span class="keyword">import</span> RMSprop</span><br><span class="line"></span><br><span class="line">model.compile(loss=<span class="string">&#x27;binary_crossentropy&#x27;</span>,</span><br><span class="line">              optimizer=RMSprop(lr=<span class="number">0.001</span>),</span><br><span class="line">              metrics=[<span class="string">&#x27;accuracy&#x27;</span>])</span><br><span class="line"><span class="comment"># åœ¨åˆ†ç±»æ—¶å°šè¡£ç‰©(fashion mnist)æ—¶ï¼Œlossæ˜¯åˆ†ç±»äº¤å‰ç†µ(sparse_categorical_crossentropy)</span></span><br><span class="line"><span class="comment"># åœ¨æ­¤å¤„åšçš„æ˜¯äºŒåˆ†ç±»ï¼Œæ‰€ä»¥ç”¨äºŒå€¼äº¤å‰ç†µ(binary_crossentropy)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### æ•°æ®é¢„å¤„ç†</span></span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.preprocessing.image <span class="keyword">import</span> ImageDataGenerator</span><br><span class="line"></span><br><span class="line"><span class="comment"># All images will be rescaled by 1./255</span></span><br><span class="line">train_datagen = ImageDataGenerator(rescale=<span class="number">1</span>/<span class="number">255</span>)</span><br><span class="line">validation_datagen = ImageDataGenerator(rescale=<span class="number">1</span>/<span class="number">255</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Flow training images in batches of 128 using train_datagen generator</span></span><br><span class="line">train_generator = train_datagen.flow_from_directory(</span><br><span class="line">        <span class="string">&#x27;/tmp/horse-or-human/&#x27;</span>,  <span class="comment"># This is the source directory for training images</span></span><br><span class="line">        target_size=(<span class="number">300</span>, <span class="number">300</span>),  <span class="comment"># All images will be resized to 300x300</span></span><br><span class="line">        batch_size=<span class="number">128</span>,</span><br><span class="line">        <span class="comment"># Since we use binary_crossentropy loss, we need binary labels</span></span><br><span class="line">        class_mode=<span class="string">&#x27;binary&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Flow training images in batches of 128 using train_datagen generator</span></span><br><span class="line">validation_generator = validation_datagen.flow_from_directory(</span><br><span class="line">        <span class="string">&#x27;/tmp/validation-horse-or-human/&#x27;</span>,  <span class="comment"># This is the source directory for training images</span></span><br><span class="line">        target_size=(<span class="number">300</span>, <span class="number">300</span>),  <span class="comment"># All images will be resized to 300x300</span></span><br><span class="line">        batch_size=<span class="number">32</span>,</span><br><span class="line">        <span class="comment"># Since we use binary_crossentropy loss, we need binary labels</span></span><br><span class="line">        class_mode=<span class="string">&#x27;binary&#x27;</span>)</span><br></pre></td></tr></table></figure>



<p>æ‰“å°æ¨¡å‹æ¦‚è¿°ä¿¡æ¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">Model: &quot;sequential&quot;</span><br><span class="line">_________________________________________________________________</span><br><span class="line">Layer (type)                 Output Shape              Param #   </span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">conv2d (Conv2D)              (None, 298, 298, 16)      448       </span><br><span class="line">_________________________________________________________________</span><br><span class="line">max_pooling2d (MaxPooling2D) (None, 149, 149, 16)      0         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv2d_1 (Conv2D)            (None, 147, 147, 32)      4640      </span><br><span class="line">_________________________________________________________________</span><br><span class="line">max_pooling2d_1 (MaxPooling2 (None, 73, 73, 32)        0         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">conv2d_2 (Conv2D)            (None, 71, 71, 64)        18496     </span><br><span class="line">_________________________________________________________________</span><br><span class="line">max_pooling2d_2 (MaxPooling2 (None, 35, 35, 64)        0         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">flatten (Flatten)            (None, 78400)             0         </span><br><span class="line">_________________________________________________________________</span><br><span class="line">dense (Dense)                (None, 512)               40141312  </span><br><span class="line">_________________________________________________________________</span><br><span class="line">dense_1 (Dense)              (None, 1)                 513       </span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Total params: 40,165,409</span><br><span class="line">Trainable params: 40,165,409</span><br><span class="line">Non-trainable params: 0</span><br><span class="line">_________________________________________________________________</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Training"><a href="#Training" class="headerlink" title="Training"></a>Training</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### æ¨¡å‹æ‹Ÿåˆ</span></span><br><span class="line">hitory = model.fit_generator(</span><br><span class="line">    train_generator,     <span class="comment"># ä»è®­ç»ƒç›®å½•ä¸­æµå¼ä¼ è¾“å›¾åƒï¼Œæˆ‘ä»¬ä¸€å…±æœ‰1024å¼ å›¾ç‰‡ï¼Œæ¯æ‰¹128ä¸ªï¼Œä¸€å…±éœ€è¦8æ‰¹</span></span><br><span class="line">    steps_per_epoch=<span class="number">8</span>,   <span class="comment"># å› ä¸ºä¸€å…±éœ€è¦8æ‰¹ï¼Œæ‰€ä»¥æ¯æ¬¡epochéƒ½éœ€è¦8ä¸ªsteps</span></span><br><span class="line">    epochs=<span class="number">15</span>,           <span class="comment"># è¿­ä»£15æ¬¡</span></span><br><span class="line">    validation_data=validation_generator,   <span class="comment"># éªŒè¯é›†</span></span><br><span class="line">    validation_steps=<span class="number">8</span>,  <span class="comment"># éªŒè¯é›†ä¸€å…±æœ‰256å¼ å›¾ç‰‡ï¼Œæ¯æ‰¹32ä¸ªï¼Œä¸€å…±éœ€è¦8æ‰¹</span></span><br><span class="line">    verbose=<span class="number">2</span>            <span class="comment"># verbose: 0, 1 æˆ– 2ã€‚æ—¥å¿—æ˜¾ç¤ºæ¨¡å¼ã€‚ 0 = å®‰é™æ¨¡å¼, 1 = è¿›åº¦æ¡, 2 = æ¯è½®ä¸€è¡Œã€‚</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>æ‰“å°ç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Epoch 1&#x2F;15</span><br><span class="line">8&#x2F;8 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 10s 1s&#x2F;step - loss: 1.2514 - accuracy: 0.5595 - val_loss: 0.7164 - val_accuracy: 0.5000</span><br><span class="line">Epoch 2&#x2F;15</span><br><span class="line">8&#x2F;8 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 7s 934ms&#x2F;step - loss: 0.6435 - accuracy: 0.6007 - val_loss: 0.4255 - val_accuracy: 0.8359</span><br><span class="line">Epoch 3&#x2F;15</span><br><span class="line">8&#x2F;8 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 7s 930ms&#x2F;step - loss: 0.7979 - accuracy: 0.5818 - val_loss: 0.6263 - val_accuracy: 0.5820</span><br><span class="line">Epoch 4&#x2F;15</span><br><span class="line">8&#x2F;8 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 8s 984ms&#x2F;step - loss: 0.6299 - accuracy: 0.7500 - val_loss: 1.7047 - val_accuracy: 0.5156</span><br><span class="line">Epoch 5&#x2F;15</span><br><span class="line">8&#x2F;8 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 7s 919ms&#x2F;step - loss: 0.4249 - accuracy: 0.8665 - val_loss: 0.9030 - val_accuracy: 0.7500</span><br><span class="line">Epoch 6&#x2F;15</span><br><span class="line">8&#x2F;8 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 7s 928ms&#x2F;step - loss: 0.4901 - accuracy: 0.7887 - val_loss: 2.9393 - val_accuracy: 0.5312</span><br><span class="line">Epoch 7&#x2F;15</span><br><span class="line">8&#x2F;8 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 8s 942ms&#x2F;step - loss: 0.3563 - accuracy: 0.8743 - val_loss: 0.5138 - val_accuracy: 0.8711</span><br><span class="line">Epoch 8&#x2F;15</span><br><span class="line">8&#x2F;8 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 8s 939ms&#x2F;step - loss: 0.1760 - accuracy: 0.9221 - val_loss: 1.0816 - val_accuracy: 0.8438</span><br><span class="line">Epoch 9&#x2F;15</span><br><span class="line">8&#x2F;8 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 7s 934ms&#x2F;step - loss: 0.2974 - accuracy: 0.8776 - val_loss: 0.7862 - val_accuracy: 0.8203</span><br><span class="line">Epoch 10&#x2F;15</span><br><span class="line">8&#x2F;8 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 7s 915ms&#x2F;step - loss: 0.1401 - accuracy: 0.9488 - val_loss: 2.0065 - val_accuracy: 0.7344</span><br><span class="line">Epoch 11&#x2F;15</span><br><span class="line">8&#x2F;8 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 7s 936ms&#x2F;step - loss: 0.2258 - accuracy: 0.9199 - val_loss: 0.6971 - val_accuracy: 0.8711</span><br><span class="line">Epoch 12&#x2F;15</span><br><span class="line">8&#x2F;8 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 8s 987ms&#x2F;step - loss: 0.3130 - accuracy: 0.9102 - val_loss: 0.7559 - val_accuracy: 0.8516</span><br><span class="line">Epoch 13&#x2F;15</span><br><span class="line">8&#x2F;8 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 8s 942ms&#x2F;step - loss: 0.0596 - accuracy: 0.9833 - val_loss: 1.4367 - val_accuracy: 0.8281</span><br><span class="line">Epoch 14&#x2F;15</span><br><span class="line">8&#x2F;8 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 8s 938ms&#x2F;step - loss: 0.0438 - accuracy: 0.9867 - val_loss: 1.6447 - val_accuracy: 0.8320</span><br><span class="line">Epoch 15&#x2F;15</span><br><span class="line">8&#x2F;8 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 7s 937ms&#x2F;step - loss: 0.1036 - accuracy: 0.9611 - val_loss: 0.9236 - val_accuracy: 0.8672</span><br></pre></td></tr></table></figure>

<h3 id="Running-the-model"><a href="#Running-the-model" class="headerlink" title="Running the model"></a>Running the model</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> google.colab <span class="keyword">import</span> files</span><br><span class="line"><span class="keyword">from</span> keras.preprocessing <span class="keyword">import</span> image</span><br><span class="line"></span><br><span class="line">uploaded = files.upload()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> fn <span class="keyword">in</span> uploaded.keys():</span><br><span class="line"> </span><br><span class="line">  <span class="comment"># predicting images</span></span><br><span class="line">  path = <span class="string">&#x27;/content/&#x27;</span> + fn</span><br><span class="line">  img = image.load_img(path, target_size=(<span class="number">300</span>, <span class="number">300</span>))</span><br><span class="line">  x = image.img_to_array(img)</span><br><span class="line">  x = np.expand_dims(x, axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">  images = np.vstack([x])</span><br><span class="line">  classes = model.predict(images, batch_size=<span class="number">10</span>)</span><br><span class="line">  print(classes[<span class="number">0</span>])</span><br><span class="line">  <span class="keyword">if</span> classes[<span class="number">0</span>]&gt;<span class="number">0.5</span>:</span><br><span class="line">    print(fn + <span class="string">&quot; is a human&quot;</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    print(fn + <span class="string">&quot; is a horse&quot;</span>)</span><br></pre></td></tr></table></figure>



<h3 id="Visualization"><a href="#Visualization" class="headerlink" title="Visualization"></a>Visualization</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.preprocessing.image <span class="keyword">import</span> img_to_array, load_img</span><br><span class="line"></span><br><span class="line"><span class="comment"># Let&#x27;s define a new Model that will take an image as input, and will output</span></span><br><span class="line"><span class="comment"># intermediate representations for all layers in the previous model after</span></span><br><span class="line"><span class="comment"># the first.</span></span><br><span class="line">successive_outputs = [layer.output <span class="keyword">for</span> layer <span class="keyword">in</span> model.layers[<span class="number">1</span>:]]</span><br><span class="line"><span class="comment">#visualization_model = Model(img_input, successive_outputs)</span></span><br><span class="line">visualization_model = tf.keras.models.Model(inputs = model.input, outputs = successive_outputs)</span><br><span class="line"><span class="comment"># Let&#x27;s prepare a random input image from the training set.</span></span><br><span class="line">horse_img_files = [os.path.join(train_horse_dir, f) <span class="keyword">for</span> f <span class="keyword">in</span> train_horse_names]</span><br><span class="line">human_img_files = [os.path.join(train_human_dir, f) <span class="keyword">for</span> f <span class="keyword">in</span> train_human_names]</span><br><span class="line">img_path = random.choice(horse_img_files + human_img_files)</span><br><span class="line"></span><br><span class="line">img = load_img(img_path, target_size=(<span class="number">300</span>, <span class="number">300</span>))  <span class="comment"># this is a PIL image</span></span><br><span class="line">x = img_to_array(img)  <span class="comment"># Numpy array with shape (150, 150, 3)</span></span><br><span class="line">x = x.reshape((<span class="number">1</span>,) + x.shape)  <span class="comment"># Numpy array with shape (1, 150, 150, 3)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Rescale by 1/255</span></span><br><span class="line">x /= <span class="number">255</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Let&#x27;s run our image through our network, thus obtaining all</span></span><br><span class="line"><span class="comment"># intermediate representations for this image.</span></span><br><span class="line">successive_feature_maps = visualization_model.predict(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># These are the names of the layers, so can have them as part of our plot</span></span><br><span class="line">layer_names = [layer.name <span class="keyword">for</span> layer <span class="keyword">in</span> model.layers[<span class="number">1</span>:]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Now let&#x27;s display our representations</span></span><br><span class="line"><span class="keyword">for</span> layer_name, feature_map <span class="keyword">in</span> zip(layer_names, successive_feature_maps):</span><br><span class="line">  <span class="keyword">if</span> len(feature_map.shape) == <span class="number">4</span>:</span><br><span class="line">    <span class="comment"># Just do this for the conv / maxpool layers, not the fully-connected layers</span></span><br><span class="line">    n_features = feature_map.shape[<span class="number">-1</span>]  <span class="comment"># number of features in feature map</span></span><br><span class="line">    <span class="comment"># The feature map has shape (1, size, size, n_features)</span></span><br><span class="line">    size = feature_map.shape[<span class="number">1</span>]</span><br><span class="line">    <span class="comment"># We will tile our images in this matrix</span></span><br><span class="line">    display_grid = np.zeros((size, size * n_features))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n_features):</span><br><span class="line">      <span class="comment"># Postprocess the feature to make it visually palatable</span></span><br><span class="line">      x = feature_map[<span class="number">0</span>, :, :, i]</span><br><span class="line">      x -= x.mean()</span><br><span class="line">      x /= x.std()</span><br><span class="line">      x *= <span class="number">64</span></span><br><span class="line">      x += <span class="number">128</span></span><br><span class="line">      x = np.clip(x, <span class="number">0</span>, <span class="number">255</span>).astype(<span class="string">&#x27;uint8&#x27;</span>)</span><br><span class="line">      <span class="comment"># We&#x27;ll tile each filter into this big horizontal grid</span></span><br><span class="line">      display_grid[:, i * size : (i + <span class="number">1</span>) * size] = x</span><br><span class="line">    <span class="comment"># Display the grid</span></span><br><span class="line">    scale = <span class="number">20.</span> / n_features</span><br><span class="line">    plt.figure(figsize=(scale * n_features, scale))</span><br><span class="line">    plt.title(layer_name)</span><br><span class="line">    plt.grid(<span class="literal">False</span>)</span><br><span class="line">    plt.imshow(display_grid, aspect=<span class="string">&#x27;auto&#x27;</span>, cmap=<span class="string">&#x27;viridis&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200807173717.png" loading="lazy"></p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200807173729.png" loading="lazy"></p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200807173750.png" loading="lazy"></p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200807173806.png" loading="lazy"></p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200807173839.png" loading="lazy"></p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200807173931.png" loading="lazy"></p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200807173948.png" loading="lazy"></p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200807174030.png" loading="lazy"></p>
<p><img src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN/images/20200807174043.png" loading="lazy"></p>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="Donate" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me money.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN@master/images/20210119090449.jpg"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN@master/images/20210119090449.jpg" alt="æ”¯ä»˜å®" title="æ”¯ä»˜å®"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN@master/images/20210119090448.png"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN@master/images/20210119090448.png" alt="QQ æ”¯ä»˜" title="QQ æ”¯ä»˜"></a><div><span style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN@master/images/20210119090450.png"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/AllMainAshley/CDN@master/images/20210119090450.png" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡æ”¯ä»˜"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author: </strong>ç¨‹æµ·ç›</li><li class="post-copyright-link"><strong>Post link: </strong><a href="https://allmainashley.github.io/2020/09/30/Notes/Machine%20Learning/Tensorflow%20Basic%20Programming/" title="Tensorflow åŸºç¡€ç¼–ç¨‹">https://allmainashley.github.io/2020/09/30/Notes/Machine%20Learning/Tensorflow%20Basic%20Programming/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> unless otherwise stated.</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2020/09/30/Notes/Machine%20Learning/Tensorflow%20Convolutional%20Neural%20Networks/" rel="prev" title="Tensorflow å·ç§¯ç½‘ç»œ"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">Tensorflow å·ç§¯ç½‘ç»œ</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2020/09/30/Notes/Machine%20Learning/Octave%20Notes/" rel="next" title="Octave å­¦ä¹ ç¬”è®°"><span class="post-nav-text">Octave å­¦ä¹ ç¬”è®°</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>è‹¥æ‚¨æ—  GitHub è´¦å·ï¼Œå¯ç›´æ¥åœ¨ä¸‹æ–¹åŒ¿åè¯„è®ºã€‚</span><br><span>è‹¥æ‚¨æƒ³åŠæ—¶å¾—åˆ°å›å¤æé†’ï¼Œå»ºè®®è·³è½¬ GitHub Issues è¯„è®ºã€‚</span><br><span>è‹¥æ²¡æœ‰æœ¬æ–‡ Issueï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Comment æ¨¡ç‰ˆæ–°å»ºã€‚</span><br><a class="hty-button hty-button--raised" id="github-issues" target="_blank" rel="noopener" href="https://github.com/AllMainAshley/AllMainAshley.github.io/issues?q=is:issue+Tensorflow åŸºç¡€ç¼–ç¨‹">GitHub Issues</a></div><div id="valine-container"></div><script>Yun.utils.getScript("https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js", () => {
  const valineConfig = {"enable":true,"appId":"duRJqtj9W4MnlhHrkhx0O3vb-gzGzoHsz","appKey":"7GxBY57ustzpxvpwNr39XneW","placeholder":"I want to say...","avatar":null,"pageSize":10,"visitor":false,"highlight":true,"recordIP":false,"enableQQ":true,"el":"#valine-container","lang":"en"}
  valineConfig.path = "/2020/09/30/Notes/Machine%20Learning/Tensorflow%20Basic%20Programming/"
  new Valine(valineConfig)
}, window.Valine);</script></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2020 â€“ 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> ç¨‹æµ·ç›</span></div><div class="powered"><span>Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> v5.2.0</span><span class="footer-separator">|</span><span>Theme - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.6.2</span></div><div class="live_time"><span>æœ¬åšå®¢å·²èŒèŒå“’åœ°è¿è¡Œ</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2020-05-10T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " å¤© " + passHour + " å°æ—¶ " + passMinute + " åˆ† " + passSecond + " ç§’";
}
blog_live_time();
</script></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="Search"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="Searching..." value=""></div><div id="local-search-result"></div></div></div></body></html>